<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<meta content="Ader's notebook" name="description"/>
<meta content="Ader" name="author"/>
<link href="https://ader817.github.io/notebook/writeups/basectf/basectf2024.html" rel="canonical"/>
<link href="../index.html" rel="prev"/>
<link href="../../assets/images/favicon.ico" rel="icon"/>
<meta content="mkdocs-1.6.1, mkdocs-material-9.5.34" name="generator"/>
<title>BaseCTF 2024 - Ader's notebook</title>
<link href="../../assets/stylesheets/main.35f28582.min.css" rel="stylesheet"/>
<link href="../../assets/stylesheets/palette.06af60db.min.css" rel="stylesheet"/>
<style>:root{--md-admonition-icon--note:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M1 7.775V2.75C1 1.784 1.784 1 2.75 1h5.025c.464 0 .91.184 1.238.513l6.25 6.25a1.75 1.75 0 0 1 0 2.474l-5.026 5.026a1.75 1.75 0 0 1-2.474 0l-6.25-6.25A1.75 1.75 0 0 1 1 7.775m1.5 0c0 .066.026.13.073.177l6.25 6.25a.25.25 0 0 0 .354 0l5.025-5.025a.25.25 0 0 0 0-.354l-6.25-6.25a.25.25 0 0 0-.177-.073H2.75a.25.25 0 0 0-.25.25ZM6 5a1 1 0 1 1 0 2 1 1 0 0 1 0-2"/></svg>');--md-admonition-icon--abstract:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M2.5 1.75v11.5c0 .138.112.25.25.25h3.17a.75.75 0 0 1 0 1.5H2.75A1.75 1.75 0 0 1 1 13.25V1.75C1 .784 1.784 0 2.75 0h8.5C12.216 0 13 .784 13 1.75v7.736a.75.75 0 0 1-1.5 0V1.75a.25.25 0 0 0-.25-.25h-8.5a.25.25 0 0 0-.25.25m13.274 9.537zl-4.557 4.45a.75.75 0 0 1-1.055-.008l-1.943-1.95a.75.75 0 0 1 1.062-1.058l1.419 1.425 4.026-3.932a.75.75 0 1 1 1.048 1.074M4.75 4h4.5a.75.75 0 0 1 0 1.5h-4.5a.75.75 0 0 1 0-1.5M4 7.75A.75.75 0 0 1 4.75 7h2a.75.75 0 0 1 0 1.5h-2A.75.75 0 0 1 4 7.75"/></svg>');--md-admonition-icon--info:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8m8-6.5a6.5 6.5 0 1 0 0 13 6.5 6.5 0 0 0 0-13M6.5 7.75A.75.75 0 0 1 7.25 7h1a.75.75 0 0 1 .75.75v2.75h.25a.75.75 0 0 1 0 1.5h-2a.75.75 0 0 1 0-1.5h.25v-2h-.25a.75.75 0 0 1-.75-.75M8 6a1 1 0 1 1 0-2 1 1 0 0 1 0 2"/></svg>');--md-admonition-icon--tip:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M3.499.75a.75.75 0 0 1 1.5 0v.996C5.9 2.903 6.793 3.65 7.662 4.376l.24.202c-.036-.694.055-1.422.426-2.163C9.1.873 10.794-.045 12.622.26 14.408.558 16 1.94 16 4.25c0 1.278-.954 2.575-2.44 2.734l.146.508.065.22c.203.701.412 1.455.476 2.226.142 1.707-.4 3.03-1.487 3.898C11.714 14.671 10.27 15 8.75 15h-6a.75.75 0 0 1 0-1.5h1.376a4.5 4.5 0 0 1-.563-1.191 3.84 3.84 0 0 1-.05-2.063 4.65 4.65 0 0 1-2.025-.293.75.75 0 0 1 .525-1.406c1.357.507 2.376-.006 2.698-.318l.009-.01a.747.747 0 0 1 1.06 0 .75.75 0 0 1-.012 1.074c-.912.92-.992 1.835-.768 2.586.221.74.745 1.337 1.196 1.621H8.75c1.343 0 2.398-.296 3.074-.836.635-.507 1.036-1.31.928-2.602-.05-.603-.216-1.224-.422-1.93l-.064-.221c-.12-.407-.246-.84-.353-1.29a2.4 2.4 0 0 1-.507-.441 3.1 3.1 0 0 1-.633-1.248.75.75 0 0 1 1.455-.364c.046.185.144.436.31.627.146.168.353.305.712.305.738 0 1.25-.615 1.25-1.25 0-1.47-.95-2.315-2.123-2.51-1.172-.196-2.227.387-2.706 1.345-.46.92-.27 1.774.019 3.062l.042.19.01.05c.348.443.666.949.94 1.553a.75.75 0 1 1-1.365.62c-.553-1.217-1.32-1.94-2.3-2.768L6.7 5.527c-.814-.68-1.75-1.462-2.692-2.619a3.7 3.7 0 0 0-1.023.88c-.406.495-.663 1.036-.722 1.508.116.122.306.21.591.239.388.038.797-.06 1.032-.19a.75.75 0 0 1 .728 1.31c-.515.287-1.23.439-1.906.373-.682-.067-1.473-.38-1.879-1.193L.75 5.677V5.5c0-.984.48-1.94 1.077-2.664.46-.559 1.05-1.055 1.673-1.353z"/></svg>');--md-admonition-icon--success:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.75.75 0 0 1 .018-1.042.75.75 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0"/></svg>');--md-admonition-icon--question:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8m8-6.5a6.5 6.5 0 1 0 0 13 6.5 6.5 0 0 0 0-13M6.92 6.085h.001a.749.749 0 1 1-1.342-.67c.169-.339.436-.701.849-.977C6.845 4.16 7.369 4 8 4a2.76 2.76 0 0 1 1.637.525c.503.377.863.965.863 1.725 0 .448-.115.83-.329 1.15-.205.307-.47.513-.692.662-.109.072-.22.138-.313.195l-.006.004a6 6 0 0 0-.26.16 1 1 0 0 0-.276.245.75.75 0 0 1-1.248-.832c.184-.264.42-.489.692-.661q.154-.1.313-.195l.007-.004c.1-.061.182-.11.258-.161a1 1 0 0 0 .277-.245C8.96 6.514 9 6.427 9 6.25a.61.61 0 0 0-.262-.525A1.27 1.27 0 0 0 8 5.5c-.369 0-.595.09-.74.187a1 1 0 0 0-.34.398M9 11a1 1 0 1 1-2 0 1 1 0 0 1 2 0"/></svg>');--md-admonition-icon--warning:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M6.457 1.047c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0 1 14.082 15H1.918a1.75 1.75 0 0 1-1.543-2.575Zm1.763.707a.25.25 0 0 0-.44 0L1.698 13.132a.25.25 0 0 0 .22.368h12.164a.25.25 0 0 0 .22-.368Zm.53 3.996v2.5a.75.75 0 0 1-1.5 0v-2.5a.75.75 0 0 1 1.5 0M9 11a1 1 0 1 1-2 0 1 1 0 0 1 2 0"/></svg>');--md-admonition-icon--failure:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M2.344 2.343za8 8 0 0 1 11.314 11.314A8.002 8.002 0 0 1 .234 10.089a8 8 0 0 1 2.11-7.746m1.06 10.253a6.5 6.5 0 1 0 9.108-9.275 6.5 6.5 0 0 0-9.108 9.275M6.03 4.97 8 6.94l1.97-1.97a.749.749 0 0 1 1.275.326.75.75 0 0 1-.215.734L9.06 8l1.97 1.97a.749.749 0 0 1-.326 1.275.75.75 0 0 1-.734-.215L8 9.06l-1.97 1.97a.749.749 0 0 1-1.275-.326.75.75 0 0 1 .215-.734L6.94 8 4.97 6.03a.75.75 0 0 1 .018-1.042.75.75 0 0 1 1.042-.018"/></svg>');--md-admonition-icon--danger:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M9.504.43a1.516 1.516 0 0 1 2.437 1.713L10.415 5.5h2.123c1.57 0 2.346 1.909 1.22 3.004l-7.34 7.142a1.25 1.25 0 0 1-.871.354h-.302a1.25 1.25 0 0 1-1.157-1.723L5.633 10.5H3.462c-1.57 0-2.346-1.909-1.22-3.004zm1.047 1.074L3.286 8.571A.25.25 0 0 0 3.462 9H6.75a.75.75 0 0 1 .694 1.034l-1.713 4.188 6.982-6.793A.25.25 0 0 0 12.538 7H9.25a.75.75 0 0 1-.683-1.06l2.008-4.418.003-.006-.004-.009-.006-.006-.008-.001q-.005 0-.009.004"/></svg>');--md-admonition-icon--bug:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M4.72.22a.75.75 0 0 1 1.06 0l1 .999a3.5 3.5 0 0 1 2.441 0l.999-1a.748.748 0 0 1 1.265.332.75.75 0 0 1-.205.729l-.775.776c.616.63.995 1.493.995 2.444v.327q0 .15-.025.292c.408.14.764.392 1.029.722l1.968-.787a.75.75 0 0 1 .556 1.392L13 7.258V9h2.25a.75.75 0 0 1 0 1.5H13v.5q-.002.615-.141 1.186l2.17.868a.75.75 0 0 1-.557 1.392l-2.184-.873A5 5 0 0 1 8 16a5 5 0 0 1-4.288-2.427l-2.183.873a.75.75 0 0 1-.558-1.392l2.17-.868A5 5 0 0 1 3 11v-.5H.75a.75.75 0 0 1 0-1.5H3V7.258L.971 6.446a.75.75 0 0 1 .558-1.392l1.967.787c.265-.33.62-.583 1.03-.722a1.7 1.7 0 0 1-.026-.292V4.5c0-.951.38-1.814.995-2.444L4.72 1.28a.75.75 0 0 1 0-1.06m.53 6.28a.75.75 0 0 0-.75.75V11a3.5 3.5 0 1 0 7 0V7.25a.75.75 0 0 0-.75-.75ZM6.173 5h3.654A.17.17 0 0 0 10 4.827V4.5a2 2 0 1 0-4 0v.327c0 .096.077.173.173.173"/></svg>');--md-admonition-icon--example:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M5 5.782V2.5h-.25a.75.75 0 0 1 0-1.5h6.5a.75.75 0 0 1 0 1.5H11v3.282l3.666 5.76C15.619 13.04 14.543 15 12.767 15H3.233c-1.776 0-2.852-1.96-1.899-3.458Zm-2.4 6.565a.75.75 0 0 0 .633 1.153h9.534a.75.75 0 0 0 .633-1.153L12.225 10.5h-8.45ZM9.5 2.5h-3V6c0 .143-.04.283-.117.403L4.73 9h6.54L9.617 6.403A.75.75 0 0 1 9.5 6Z"/></svg>');--md-admonition-icon--quote:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M1.75 2.5h10.5a.75.75 0 0 1 0 1.5H1.75a.75.75 0 0 1 0-1.5m4 5h8.5a.75.75 0 0 1 0 1.5h-8.5a.75.75 0 0 1 0-1.5m0 5h8.5a.75.75 0 0 1 0 1.5h-8.5a.75.75 0 0 1 0-1.5M2.5 7.75v6a.75.75 0 0 1-1.5 0v-6a.75.75 0 0 1 1.5 0"/></svg>');}</style>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=JetBrains+Mono,+LXGW+WenKai+Screen+GB+Screen:300,300i,400,400i,700,700i%7CJetBrains+Mono,+Consolas:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"JetBrains Mono, LXGW WenKai Screen GB Screen";--md-code-font:"JetBrains Mono, Consolas"}</style>
<link href="../../css/heti.css" rel="stylesheet"/>
<link href="../../assets/stylesheets/custom.css" rel="stylesheet"/>
<link href="https://unpkg.com/katex@0/dist/katex.min.css" rel="stylesheet"/>
<link href="https://gcore.jsdelivr.net/npm/lxgw-wenkai-screen-webfont@1.1.0/style.css" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:ital,wght@0,100..800;1,100..800&amp;display=swap" rel="stylesheet"/>
<script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
</head>
<body data-md-color-accent="indigo" data-md-color-primary="blue-grey" data-md-color-scheme="default" dir="ltr">
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#week1-根本进不去啊">
          跳转至
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header" data-md-component="header">
<nav aria-label="页眉" class="md-header__inner md-grid">
<a aria-label="Ader's notebook" class="md-header__button md-logo" data-md-component="logo" href="../.." title="Ader's notebook">
<svg viewbox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M.989 8 .064 2.68a1.342 1.342 0 0 1 1.85-1.462l13.402 5.744a1.13 1.13 0 0 1 0 2.076L1.913 14.782a1.343 1.343 0 0 1-1.85-1.463L.99 8Zm.603-5.288L2.38 7.25h4.87a.75.75 0 0 1 0 1.5H2.38l-.788 4.538L13.929 8Z"></path></svg>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            Ader's notebook
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              BaseCTF 2024
            
          </span>
</div>
</div>
</div>
<form class="md-header__option" data-md-component="palette">
<input aria-label="切换至夜间模式" class="md-option" data-md-color-accent="indigo" data-md-color-media="(prefers-color-scheme: light)" data-md-color-primary="blue-grey" data-md-color-scheme="default" id="__palette_0" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_1" hidden="" title="切换至夜间模式">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg>
</label>
<input aria-label="切换至日间模式" class="md-option" data-md-color-accent="teal" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-primary="black" data-md-color-scheme="slate" id="__palette_1" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_0" hidden="" title="切换至日间模式">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg>
</label>
</form>
<script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="搜索" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="搜索" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg>
</label>
<nav aria-label="查找" class="md-search__options">
<a aria-label="分享" class="md-search__icon md-icon" data-clipboard="" data-clipboard-text="" data-md-component="search-share" href="javascript:void(0)" tabindex="-1" title="分享">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"></path></svg>
</a>
<button aria-label="清空当前内容" class="md-search__icon md-icon" tabindex="-1" title="清空当前内容" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg>
</button>
</nav>
<div class="md-search__suggest" data-md-component="search-suggest"></div>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="" tabindex="0">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
<ol class="md-search-result__list" role="presentation"></ol>
</div>
</div>
</div>
</div>
</div>
<div class="md-header__source">
<a class="md-source" data-md-component="source" href="https://github.com/Ader817/notebook/" title="前往仓库">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"></path></svg>
</div>
<div class="md-source__repository">
    Ader817/notebook
  </div>
</a>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<nav aria-label="标签" class="md-tabs" data-md-component="tabs">
<div class="md-grid">
<ul class="md-tabs__list">
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../index.html">
          
  
    
  
  Home

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../algorithm/index.html">
          
  
    
  
  Algorithm

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../software/index.html">
          
  
    
  
  Software

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../system/index.html">
          
  
    
  
  System

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../math/index.html">
          
  
    
  
  Math

        </a>
</li>
<li class="md-tabs__item md-tabs__item--active">
<a class="md-tabs__link" href="../index.html">
          
  
    
  
  Writeups

        </a>
</li>
</ul>
</div>
</nav>
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="导航栏" class="md-nav md-nav--primary md-nav--lifted" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="Ader's notebook" class="md-nav__button md-logo" data-md-component="logo" href="../.." title="Ader's notebook">
<svg viewbox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M.989 8 .064 2.68a1.342 1.342 0 0 1 1.85-1.462l13.402 5.744a1.13 1.13 0 0 1 0 2.076L1.913 14.782a1.343 1.343 0 0 1-1.85-1.463L.99 8Zm.603-5.288L2.38 7.25h4.87a.75.75 0 0 1 0 1.5H2.38l-.788 4.538L13.929 8Z"></path></svg>
</a>
    Ader's notebook
  </label>
<div class="md-nav__source">
<a class="md-source" data-md-component="source" href="https://github.com/Ader817/notebook/" title="前往仓库">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"></path></svg>
</div>
<div class="md-source__repository">
    Ader817/notebook
  </div>
</a>
</div>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../index.html">
<span class="md-ellipsis">
    Home
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../algorithm/index.html">
<span class="md-ellipsis">
    Algorithm
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../software/index.html">
<span class="md-ellipsis">
    Software
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../system/index.html">
<span class="md-ellipsis">
    System
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../math/index.html">
<span class="md-ellipsis">
    Math
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_6" type="checkbox"/>
<div class="md-nav__link md-nav__container">
<a class="md-nav__link" href="../index.html">
<span class="md-ellipsis">
    Writeups
  </span>
</a>
<label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="true" aria-labelledby="__nav_6_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_6">
<span class="md-nav__icon md-icon"></span>
            Writeups
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_6_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_6_2" id="__nav_6_2_label" tabindex="0">
<span class="md-ellipsis">
    2024
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="true" aria-labelledby="__nav_6_2_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_6_2">
<span class="md-nav__icon md-icon"></span>
            2024
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
<span class="md-ellipsis">
    BaseCTF 2024
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="basectf2024.html">
<span class="md-ellipsis">
    BaseCTF 2024
  </span>
</a>
<nav aria-label="目录" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      目录
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#week1-根本进不去啊">
<span class="md-ellipsis">
      [Week1] 根本进不去啊
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#week1-海上遇到了鲨鱼">
<span class="md-ellipsis">
      [Week1] 海上遇到了鲨鱼
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#week1-base">
<span class="md-ellipsis">
      [Week1] Base
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#week1-倒计时海报">
<span class="md-ellipsis">
      [Week1] 倒计时？海报！
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#week1-签到dk盾">
<span class="md-ellipsis">
      [Week1] 签到！DK盾！
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#week1-喵喵太可爱了">
<span class="md-ellipsis">
      [Week1] 喵喵太可爱了
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#week1-人生苦短我用python">
<span class="md-ellipsis">
      [Week1] 人生苦短，我用python
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#week1-你也喜欢圣物吗">
<span class="md-ellipsis">
      [Week1] 你也喜欢圣物吗
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#week1-正着看还是反着看">
<span class="md-ellipsis">
      [Week1] 正着看还是反着看
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#week1-捂住x只耳">
<span class="md-ellipsis">
      [Week1] 捂住X只耳
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#week2-ez_crypto">
<span class="md-ellipsis">
      [Week2] ez_crypto
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#week2-base">
<span class="md-ellipsis">
      [Week2] base?!
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#week-2-二维码1-街头小广告">
<span class="md-ellipsis">
      [Week 2] 二维码1-街头小广告
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#week-2-前辈什么的最喜欢了">
<span class="md-ellipsis">
      [Week 2] 前辈什么的最喜欢了
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#week2-黑丝上的flag">
<span class="md-ellipsis">
      [Week2] 黑丝上的flag
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#week2-海上又遇到了鲨鱼">
<span class="md-ellipsis">
      [Week2] 海上又遇到了鲨鱼
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#week2-反方向的雪">
<span class="md-ellipsis">
      [Week2] 反方向的雪
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#week2-哇珍德食泥鸭">
<span class="md-ellipsis">
      [Week2] 哇！珍德食泥鸭
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#week3-纯鹿人">
<span class="md-ellipsis">
      [Week3] 纯鹿人
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#week3-base-revenge">
<span class="md-ellipsis">
      [Week3] Base Revenge
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#week3-白丝上的flag">
<span class="md-ellipsis">
      [Week3] 白丝上的flag
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#week3">
<span class="md-ellipsis">
      [Week3]
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#week4-二维码2-阿喀琉斯之踵">
<span class="md-ellipsis">
      [Week4] 二维码2-阿喀琉斯之踵
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="目录" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      目录
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#week1-根本进不去啊">
<span class="md-ellipsis">
      [Week1] 根本进不去啊
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#week1-海上遇到了鲨鱼">
<span class="md-ellipsis">
      [Week1] 海上遇到了鲨鱼
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#week1-base">
<span class="md-ellipsis">
      [Week1] Base
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#week1-倒计时海报">
<span class="md-ellipsis">
      [Week1] 倒计时？海报！
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#week1-签到dk盾">
<span class="md-ellipsis">
      [Week1] 签到！DK盾！
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#week1-喵喵太可爱了">
<span class="md-ellipsis">
      [Week1] 喵喵太可爱了
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#week1-人生苦短我用python">
<span class="md-ellipsis">
      [Week1] 人生苦短，我用python
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#week1-你也喜欢圣物吗">
<span class="md-ellipsis">
      [Week1] 你也喜欢圣物吗
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#week1-正着看还是反着看">
<span class="md-ellipsis">
      [Week1] 正着看还是反着看
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#week1-捂住x只耳">
<span class="md-ellipsis">
      [Week1] 捂住X只耳
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#week2-ez_crypto">
<span class="md-ellipsis">
      [Week2] ez_crypto
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#week2-base">
<span class="md-ellipsis">
      [Week2] base?!
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#week-2-二维码1-街头小广告">
<span class="md-ellipsis">
      [Week 2] 二维码1-街头小广告
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#week-2-前辈什么的最喜欢了">
<span class="md-ellipsis">
      [Week 2] 前辈什么的最喜欢了
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#week2-黑丝上的flag">
<span class="md-ellipsis">
      [Week2] 黑丝上的flag
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#week2-海上又遇到了鲨鱼">
<span class="md-ellipsis">
      [Week2] 海上又遇到了鲨鱼
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#week2-反方向的雪">
<span class="md-ellipsis">
      [Week2] 反方向的雪
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#week2-哇珍德食泥鸭">
<span class="md-ellipsis">
      [Week2] 哇！珍德食泥鸭
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#week3-纯鹿人">
<span class="md-ellipsis">
      [Week3] 纯鹿人
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#week3-base-revenge">
<span class="md-ellipsis">
      [Week3] Base Revenge
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#week3-白丝上的flag">
<span class="md-ellipsis">
      [Week3] 白丝上的flag
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#week3">
<span class="md-ellipsis">
      [Week3]
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#week4-二维码2-阿喀琉斯之踵">
<span class="md-ellipsis">
      [Week4] 二维码2-阿喀琉斯之踵
    </span>
</a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<a class="md-content__button md-icon" href="https://github.com/Ader817/notebook/edit/master/docs/writeups/basectf/basectf2024.md" title="编辑此页">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"></path></svg>
</a>
<a class="md-content__button md-icon" href="https://github.com/Ader817/notebook/raw/master/docs/writeups/basectf/basectf2024.md" title="查看本页的源代码">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"></path></svg>
</a>
<h1>BaseCTF 2024</h1>
<h2 id="week1-根本进不去啊"><span>[Week1]<span class="heti-spacing"> </span></span>根本进不去啊</h2>
<p>最开始通过 <code>nslookup txt flag.basectf.fun</code>试图查询<span class="heti-skip"><span class="heti-spacing"> </span>DNS<span class="heti-spacing"> </span></span>记录，发现域名对应的主机地址不存在</p>
<p>那么<span class="heti-skip"><span class="heti-spacing"> </span>flag<span class="heti-spacing"> </span></span>可能被隐藏在了<span class="heti-skip"><span class="heti-spacing"> </span>DNS<span class="heti-spacing"> </span></span>的<span class="heti-skip"><span class="heti-spacing"> </span>txt<span class="heti-spacing"> </span></span>记录中</p>
<p>通过<span class="heti-skip"><span class="heti-spacing"> </span>dig<span class="heti-spacing"> </span></span>查询<span class="heti-skip"><span class="heti-spacing"> </span>DNS<span class="heti-spacing"> </span></span>解析的<span class="heti-skip"><span class="heti-spacing"> </span>txt<span class="heti-spacing"> </span></span>记录，键入命令 <code>dig txt flag.basectf.fun</code></p>
<p>或者使用<span class="heti-skip"><span class="heti-spacing"> </span>nslookup<span class="heti-spacing"> </span></span>同理键入命令 <code>nslookup -query=TXT flag.basectf.fun</code>即可得到</p>
<p>一段<span class="heti-skip"><span class="heti-spacing"> </span>txt<span class="heti-spacing"> </span></span>记录<code>text = "FLAG: BaseCTF{h0h0_th1s_15_dns_rec0rd}"</code></p>
<h2 id="week1-海上遇到了鲨鱼"><span>[Week1]<span class="heti-spacing"> </span></span>海上遇到了鲨鱼</h2>
<p>附件给了一个<span class="heti-skip"><span class="heti-spacing"> </span>.pcapang<span class="heti-spacing"> </span></span>文件，用<span class="heti-skip"><span class="heti-spacing"> </span>wireshark<span class="heti-spacing"> </span></span>打开这个流量包，主要为<span class="heti-skip"><span class="heti-spacing"> </span>HTTP<span class="heti-spacing"> </span></span>和<span class="heti-skip"><span class="heti-spacing"> </span>TCP<span class="heti-spacing"> </span></span>的流量</p>
<p>找到了<code>GET /wireshark/flag.jpg HTTP/1.1</code>的<span><span class="heti-spacing"> </span>Info</span>，我们主要关注<span class="heti-skip"><span class="heti-spacing"> </span>HTTP<span class="heti-spacing"> </span></span>协议</p>
<p>因此导出<span class="heti-skip"><span class="heti-spacing"> </span>HTTP<span class="heti-spacing"> </span></span>对象，在<span class="heti-skip"><span class="heti-spacing"> </span>flag.php<span class="heti-spacing"> </span></span>中找到了一段文本<code>}67bf613763ca-50b3-4437-7a3a-b683fe51{FTCesaB</code></p>
<p>显然为<span class="heti-skip"><span class="heti-spacing"> </span>flag<span class="heti-spacing"> </span></span>的倒置，因此倒置回来就可以得到<span><span class="heti-spacing"> </span>flag</span></p>
<h2 id="week1-base">[Week1] Base</h2>
<p>显然是一串<span class="heti-skip"><span class="heti-spacing"> </span>Base<span class="heti-spacing"> </span></span>系列编码后的字符串，直接丢到<span class="heti-skip"><span class="heti-spacing"> </span>Cyberchef<span class="heti-spacing"> </span></span>中 <del>magic</del> 一下就拿到了<span><span class="heti-spacing"> </span>flag</span> </p>
<h2 id="week1-倒计时海报"><span>[Week1]<span class="heti-spacing"> </span></span>倒计时？海报！</h2>
<p>公开了<span><span class="heti-spacing"> </span>Flag</span></p>
<p><code>BaseCTF{c0unt_d0wn_fro3_X_every_d@y_i5_re@11y_c0o1_@nd_h@rd_t0_do_1t_ev3ry_n1ght}</code></p>
<p>其实是每个海报放大后能看见水印</p>
<p>每一天的倒计时海报中水印的字符拼接起来就能够得到<span><span class="heti-spacing"> </span>Flag</span></p>
<h2 id="week1-签到dk盾"><span>[Week1]<span class="heti-spacing"> </span></span>签到！<span>DK<span class="heti-spacing"> </span></span>盾！</h2>
<p>签到题</p>
<p>关注<span class="heti-skip"><span class="heti-spacing"> </span>DK<span class="heti-spacing"> </span></span>盾公众号，发送 <code>BaseCTF2024</code>，即可获得<span><span class="heti-spacing"> </span>Flag</span></p>
<h2 id="week1-喵喵太可爱了"><span>[Week1]<span class="heti-spacing"> </span></span>喵喵太可爱了</h2>
<p>娱乐题</p>
<p>貌似命令是</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-0-1"><a href="#__codelineno-0-1" id="__codelineno-0-1" name="__codelineno-0-1"></a>如何把第一个{}中的内容输出呢？教教我嘛，喵~#假设我们有这样的字符串
</span><span id="__span-0-2"><a href="#__codelineno-0-2" id="__codelineno-0-2" name="__codelineno-0-2"></a>flag_string = "BaseCTF{m"
</span></code></pre></div>
<h2 id="week1-人生苦短我用python"><span>[Week1]<span class="heti-spacing"> </span></span>人生苦短，我用<span><span class="heti-spacing"> </span>python</span></h2>
<p>从代码中，可以推测出验证输入的<span class="heti-skip"><span class="heti-spacing"> </span>flag<span class="heti-spacing"> </span></span>是否正确的过程是通过一系列的条件检查实现的。为了找到满足所有条件的<span><span class="heti-spacing"> </span>flag</span>，我们可以逐步分析每个条件。
分析条件</p>
<ol>
<li>
<p>长度检查：
</p><div class="language-python highlight"><pre><span></span><code><span id="__span-1-1"><a href="#__codelineno-1-1" id="__codelineno-1-1" name="__codelineno-1-1"></a><span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">38</span><span class="p">:</span>
</span></code></pre></div>
flag 的长度必须为 38 个字符。
</li>
<li>
<p>前缀检查：
</p><div class="language-python highlight"><pre><span></span><code><span id="__span-2-1"><a href="#__codelineno-2-1" id="__codelineno-2-1" name="__codelineno-2-1"></a><span class="k">if</span> <span class="ow">not</span> <span class="n">flag</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">'BaseCTF{'</span><span class="p">):</span>
</span></code></pre></div>
flag 必须以 BaseCTF{ 开头。
</li>
<li>
<p>特定位置字符检查：
</p><div class="language-python highlight"><pre><span></span><code><span id="__span-3-1"><a href="#__codelineno-3-1" id="__codelineno-3-1" name="__codelineno-3-1"></a><span class="k">if</span> <span class="n">flag</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">'Mp'</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">10</span><span class="p">:</span>
</span></code></pre></div>
flag 中 "Mp" 的位置必须是索引 10。
</li>
<li>
<p>特定末尾检查：
</p><div class="language-python highlight"><pre><span></span><code><span id="__span-4-1"><a href="#__codelineno-4-1" id="__codelineno-4-1" name="__codelineno-4-1"></a><span class="k">if</span> <span class="n">flag</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">:]</span> <span class="o">*</span> <span class="mi">8</span> <span class="o">!=</span> <span class="s1">'3x}3x}3x}3x}3x}3x}3x}3x}'</span><span class="p">:</span>
</span></code></pre></div>
flag 的最后 3 个字符乘 8 必须等于 '3x}3x}3x}3x}3x}3x}3x}3x}'，因此最后 3 个字符为 '3x}'。
</li>
<li>
<p>最后一个字符检查：
</p><div class="language-python highlight"><pre><span></span><code><span id="__span-5-1"><a href="#__codelineno-5-1" id="__codelineno-5-1" name="__codelineno-5-1"></a><span class="k">if</span> <span class="nb">ord</span><span class="p">(</span><span class="n">flag</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">!=</span> <span class="mi">125</span><span class="p">:</span>
</span></code></pre></div>
flag 的最后一个字符的 ASCII 码必须为 125，即 }。
</li>
<li>
<p>下划线检查：
</p><div class="language-python highlight"><pre><span></span><code><span id="__span-6-1"><a href="#__codelineno-6-1" id="__codelineno-6-1" name="__codelineno-6-1"></a><span class="k">if</span> <span class="n">flag</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s1">'_'</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
</span></code></pre></div>
flag 中的下划线数量必须为 4（因为 4 // 2 == 2）。
</li>
<li>
<p>下划线分割后的长度检查：
</p><div class="language-python highlight"><pre><span></span><code><span id="__span-7-1"><a href="#__codelineno-7-1" id="__codelineno-7-1" name="__codelineno-7-1"></a><span class="k">if</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">len</span><span class="p">,</span> <span class="n">flag</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">'_'</span><span class="p">)))</span> <span class="o">!=</span> <span class="p">[</span><span class="mi">14</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">]:</span>
</span></code></pre></div>
按下划线 split 后，每部分的长度应为 [14, 2, 6, 4, 8]。
</li>
<li>
<p>步长为<span class="heti-skip"><span class="heti-spacing"> </span>4<span class="heti-spacing"> </span></span>的子串检查：
</p><div class="language-python highlight"><pre><span></span><code><span id="__span-8-1"><a href="#__codelineno-8-1" id="__codelineno-8-1" name="__codelineno-8-1"></a><span class="k">if</span> <span class="n">flag</span><span class="p">[</span><span class="mi">12</span><span class="p">:</span><span class="mi">32</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">'lsT_n'</span><span class="p">:</span>
</span></code></pre></div>
从索引 12 开始，每 4 个字符一个，必须得到 'lsT_n'。
</li>
<li>
<p>字符替换检查：
</p><div class="language-python highlight"><pre><span></span><code><span id="__span-9-1"><a href="#__codelineno-9-1" id="__codelineno-9-1" name="__codelineno-9-1"></a><span class="k">if</span> <span class="s1">'馃樅'</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">c</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">flag</span><span class="p">[:</span><span class="mi">9</span><span class="p">]])</span> <span class="o">!=</span> <span class="n">B馃樅A馃樅S馃樅E馃樅C馃樅T馃樅F馃樅</span><span class="p">{</span><span class="n">馃樅S</span><span class="s1">'</span>
</span></code></pre></div>
flag 的前 9 个字符的大写必须是 'BASECTF{S'
</li>
<li>
<p>数值字符检查：
</p><div class="language-python highlight"><pre><span></span><code><span id="__span-10-1"><a href="#__codelineno-10-1" id="__codelineno-10-1" name="__codelineno-10-1"></a><span class="k">if</span> <span class="ow">not</span> <span class="n">flag</span><span class="p">[</span><span class="o">-</span><span class="mi">11</span><span class="p">]</span><span class="o">.</span><span class="n">isnumeric</span><span class="p">()</span> <span class="ow">or</span> <span class="nb">int</span><span class="p">(</span><span class="n">flag</span><span class="p">[</span><span class="o">-</span><span class="mi">11</span><span class="p">])</span> <span class="o">**</span> <span class="mi">5</span> <span class="o">!=</span> <span class="mi">1024</span><span class="p">:</span>
</span></code></pre></div>
flag 的倒数第 11 个字符必须是一个数字，并且它的 5 次方为 1024，即 4。
</li>
<li>
<p><span>Base64<span class="heti-spacing"> </span></span>编码检查：
</p><div class="language-python highlight"><pre><span></span><code><span id="__span-11-1"><a href="#__codelineno-11-1" id="__codelineno-11-1" name="__codelineno-11-1"></a><span class="k">if</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="n">flag</span><span class="p">[</span><span class="o">-</span><span class="mi">7</span><span class="p">:</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span> <span class="o">!=</span> <span class="sa">b</span><span class="s1">'MG1QbA=='</span><span class="p">:</span>
</span></code></pre></div>
flag 的倒数第 7 到第 3 个字符（不含倒数第 3 个）Base64 编码后应为 'MG1QbA=='，即 'G1Pa'。
</li>
<li>
<p>逆序步长检查：
</p><div class="language-python highlight"><pre><span></span><code><span id="__span-12-1"><a href="#__codelineno-12-1" id="__codelineno-12-1" name="__codelineno-12-1"></a><span class="k">if</span> <span class="n">flag</span><span class="p">[::</span><span class="o">-</span><span class="mi">7</span><span class="p">]</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span><span class="o">.</span><span class="n">hex</span><span class="p">()</span> <span class="o">!=</span> <span class="s1">'7d4372733173'</span><span class="p">:</span>
</span></code></pre></div>
逆序每 7 个字符的ASCII码十六进制表示为 '7d4372733173',即'}Crs1s'
</li>
<li>
<p>特定集合检查：
</p><div class="language-python highlight"><pre><span></span><code><span id="__span-13-1"><a href="#__codelineno-13-1" id="__codelineno-13-1" name="__codelineno-13-1"></a><span class="k">if</span> <span class="nb">set</span><span class="p">(</span><span class="n">flag</span><span class="p">[</span><span class="mi">12</span><span class="p">::</span><span class="mi">11</span><span class="p">])</span> <span class="o">!=</span> <span class="p">{</span><span class="s1">'l'</span><span class="p">,</span> <span class="s1">'r'</span><span class="p">}:</span>
</span></code></pre></div>
从索引 12 开始，每 11 个字符取一个，结果的集合应为 {'l', 'r'}。
</li>
<li>
<p>字节序列检查：
</p><div class="language-python highlight"><pre><span></span><code><span id="__span-14-1"><a href="#__codelineno-14-1" id="__codelineno-14-1" name="__codelineno-14-1"></a><span class="k">if</span> <span class="n">flag</span><span class="p">[</span><span class="mi">21</span><span class="p">:</span><span class="mi">27</span><span class="p">]</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span> <span class="o">!=</span> <span class="nb">bytes</span><span class="p">([</span><span class="mi">116</span><span class="p">,</span> <span class="mi">51</span><span class="p">,</span> <span class="mi">114</span><span class="p">,</span> <span class="mi">95</span><span class="p">,</span> <span class="mi">84</span><span class="p">,</span> <span class="mi">104</span><span class="p">]):</span>
</span></code></pre></div>
索引 21 到 26 的子字符串的字节序列应为 [116, 51, 114, 95, 84, 104]，即 't3r_Th'。
</li>
<li>
<p>累加校验：
</p><div class="language-python highlight"><pre><span></span><code><span id="__span-15-1"><a href="#__codelineno-15-1" id="__codelineno-15-1" name="__codelineno-15-1"></a><span class="k">if</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2024_08_15</span> <span class="o">**</span> <span class="n">idx</span> <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">flag</span><span class="p">[</span><span class="mi">17</span><span class="p">:</span><span class="mi">20</span><span class="p">]))</span> <span class="o">!=</span> <span class="mi">41378751114180610</span><span class="p">:</span>
</span></code></pre></div>
索引 17 到 19 的字符经过特定计算应得 41378751114180610。
可以写一个爆破脚本找到18及19位数，17位已知为'_'
</li>
</ol>
<div class="language-python highlight"><pre><span></span><code><span id="__span-16-1"><a href="#__codelineno-16-1" id="__codelineno-16-1" name="__codelineno-16-1"></a><span class="n">key</span> <span class="o">=</span> <span class="mi">41378751114180610</span> <span class="o">-</span> <span class="nb">ord</span><span class="p">(</span><span class="s1">'_'</span><span class="p">)</span>
</span><span id="__span-16-2"><a href="#__codelineno-16-2" id="__codelineno-16-2" name="__codelineno-16-2"></a><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">128</span><span class="p">):</span>
</span><span id="__span-16-3"><a href="#__codelineno-16-3" id="__codelineno-16-3" name="__codelineno-16-3"></a>    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">128</span><span class="p">):</span>
</span><span id="__span-16-4"><a href="#__codelineno-16-4" id="__codelineno-16-4" name="__codelineno-16-4"></a>        <span class="k">if</span> <span class="n">i</span> <span class="o">*</span> <span class="mi">2024_08_15</span> <span class="o">+</span> <span class="n">j</span> <span class="o">*</span> <span class="mi">2024_08_15</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">==</span> <span class="n">key</span><span class="p">:</span>
</span><span id="__span-16-5"><a href="#__codelineno-16-5" id="__codelineno-16-5" name="__codelineno-16-5"></a>            <span class="nb">print</span><span class="p">(</span><span class="nb">chr</span><span class="p">(</span><span class="n">i</span><span class="p">),</span><span class="nb">chr</span><span class="p">(</span><span class="n">j</span><span class="p">))</span>
</span></code></pre></div>
<p>得到<span><span class="heti-spacing"> </span>B</span>，e</p>
<ol>
<li>
<p>字符属性检查：
</p><div class="language-python highlight"><pre><span></span><code><span id="__span-17-1"><a href="#__codelineno-17-1" id="__codelineno-17-1" name="__codelineno-17-1"></a><span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">([</span><span class="n">flag</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isalpha</span><span class="p">(),</span> <span class="n">flag</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="o">.</span><span class="n">islower</span><span class="p">(),</span> <span class="n">flag</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span><span class="o">.</span><span class="n">isdigit</span><span class="p">()]):</span>
</span></code></pre></div>
索引 0 的字符应为字母，索引 8 的字符应为小写字母，索引 13 的字符应为数字。
</li>
<li>
<p>格式化检查：
</p><div class="language-python highlight"><pre><span></span><code><span id="__span-18-1"><a href="#__codelineno-18-1" id="__codelineno-18-1" name="__codelineno-18-1"></a><span class="k">if</span> <span class="s1">'</span><span class="si">{whats}</span><span class="s1"> </span><span class="si">{up}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">whats</span><span class="o">=</span><span class="n">flag</span><span class="p">[</span><span class="mi">13</span><span class="p">],</span> <span class="n">up</span><span class="o">=</span><span class="n">flag</span><span class="p">[</span><span class="mi">15</span><span class="p">])</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'3'</span><span class="p">,</span> <span class="s1">'bro'</span><span class="p">)</span> <span class="o">!=</span> <span class="s1">'bro 1'</span><span class="p">:</span>
</span></code></pre></div>
格式化后的字符串应该是 '3 1'，并替换 '3' 为 'bro' 得 'bro 1'，即 flag[13] 为 '3'，flag[15] 为 '1'。
<strong>这样其实就已经得到了<span class="heti-skip"><span class="heti-spacing"> </span>Flag<span class="heti-spacing"> </span></span>的内容</strong>
</li>
</ol>
<p><code>BaseCTF{s1Mpl3_1s_BeTt3r_Th4n_C0mPl3x}</code></p>
<ol>
<li><span>SHA1<span class="heti-spacing"> </span></span>校验：
<div class="language-python highlight"><pre><span></span><code><span id="__span-19-1"><a href="#__codelineno-19-1" id="__codelineno-19-1" name="__codelineno-19-1"></a><span class="k">if</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha1</span><span class="p">(</span><span class="n">flag</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span> <span class="o">!=</span> <span class="s1">'e40075055f34f88993f47efb3429bd0e44a7f479'</span><span class="p">:</span>
</span></code></pre></div>
整个 flag 的 SHA-1 哈希应为 'e40075055f34f88993f47efb3429bd0e44a7f479'。</li>
</ol>
<p>分析完所有检查条件后，我们知道<span class="heti-skip"><span class="heti-spacing"> </span>flag<span class="heti-spacing"> </span></span>应该满足所有给定的检查条件，因此我们能推断出<span class="heti-skip"><span class="heti-spacing"> </span>flag<span class="heti-spacing"> </span></span>为</p>
<p><code>BaseCTF{SLsT_4_Th3rs_3x}</code></p>
<h2 id="week1-你也喜欢圣物吗"><span>[Week1]<span class="heti-spacing"> </span></span>你也喜欢圣物吗</h2>
<p>打开附件可以得到一个<span class="heti-skip"><span class="heti-spacing"> </span>.zip<span class="heti-spacing"> </span></span>文件<span class="heti-skip"><span class="heti-spacing"> </span>where_is_key<span class="heti-spacing"> </span></span>和一个<span class="heti-skip"><span class="heti-spacing"> </span>.png<span class="heti-spacing"> </span></span>文件</p>
<p><span>where_is_key<span class="heti-spacing"> </span></span>需要密码来解压，猜测密码被隐写在了<span class="heti-skip"><span class="heti-spacing"> </span>png<span class="heti-spacing"> </span></span>图片中，利用<span class="heti-skip"><span class="heti-spacing"> </span>zsteg<span class="heti-spacing"> </span></span>自动枚举识别图片中的隐写字段</p>
<p>可以得到密码为<code>lud1_lud1</code></p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-20-1"><a href="#__codelineno-20-1" id="__codelineno-20-1" name="__codelineno-20-1"></a>b1,rgb,lsb,xy<span class="w">       </span>..<span class="w"> </span>text:<span class="w"> </span><span class="s2">"key=lud1_lud1"</span>
</span></code></pre></div>
<p>得到密码后继续解压得到一个需要密码的名为<span class="heti-skip"><span class="heti-spacing"> </span>it is fake<span class="heti-spacing"> </span></span>的<span class="heti-skip"><span class="heti-spacing"> </span>.zip<span class="heti-spacing"> </span></span>文件</p>
<p>根据提示<span><span class="heti-spacing"> </span>"</span><strong><span>where_is_key.zip<span class="heti-spacing"> </span></span>真的需要密码，再找找</strong>"，猜测可能这个文件利用了<span class="heti-skip"><span class="heti-spacing"> </span>zip<span class="heti-spacing"> </span></span>伪加密技术</p>
<p>使用<span class="heti-skip"><span class="heti-spacing"> </span>010 Editor<span class="heti-spacing"> </span></span>打开该<span class="heti-skip"><span class="heti-spacing"> </span>zip<span class="heti-spacing"> </span></span>文件<span class="heti-skip"><span class="heti-spacing"> </span>,<span class="heti-spacing"> </span></span>将数据区和目录区的全局方式位标记都更改为<span class="heti-skip"><span class="heti-spacing"> </span>00 00<span class="heti-spacing"> </span></span>并保存</p>
<p>再次解压<span class="heti-skip"><span class="heti-spacing"> </span>zip<span class="heti-spacing"> </span></span>文件就可以得到<span><span class="heti-spacing"> </span>flag.txt</span>，有两段明显为<span class="heti-skip"><span class="heti-spacing"> </span>Base<span class="heti-spacing"> </span></span>系列特征的编码</p>
<p>其中上方的是假<span><span class="heti-spacing"> </span>flag</span>，<span>From Base64<span class="heti-spacing"> </span></span>后得到<code>flag{0h_n0_it's_f3ke}</code></p>
<p>许多个换行后下方的是真正的<span><span class="heti-spacing"> </span>flag</span>，两次<span class="heti-skip"><span class="heti-spacing"> </span>From Base64<span class="heti-spacing"> </span></span>后得到<code>BaseCTF{1u0_q1_x1_51k1}</code></p>
<h2 id="week1-正着看还是反着看"><span>[Week1]<span class="heti-spacing"> </span></span>正着看还是反着看</h2>
<p>打开附件能够得到一个<span class="heti-skip"><span class="heti-spacing"> </span>data<span class="heti-spacing"> </span></span>类型即纯二进制数据的<span class="heti-skip"><span class="heti-spacing"> </span>flag<span class="heti-spacing"> </span></span>文件，并且<span class="heti-skip"><span class="heti-spacing"> </span>cat<span class="heti-spacing"> </span></span>将其输出后发现是一段乱码</p>
<p>结合题目名称可以猜测要将二进制数据反向，于是我们可以撰写一个<span class="heti-skip"><span class="heti-spacing"> </span>python<span class="heti-spacing"> </span></span>脚本来倒置二进制数据</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-21-1"><a href="#__codelineno-21-1" id="__codelineno-21-1" name="__codelineno-21-1"></a><span class="k">def</span> <span class="nf">reverse_file</span><span class="p">(</span><span class="n">input_file</span><span class="p">,</span> <span class="n">output_file</span><span class="p">):</span>
</span><span id="__span-21-2"><a href="#__codelineno-21-2" id="__codelineno-21-2" name="__codelineno-21-2"></a>    <span class="c1"># 打开输入文件并读取其内容</span>
</span><span id="__span-21-3"><a href="#__codelineno-21-3" id="__codelineno-21-3" name="__codelineno-21-3"></a>    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">input_file</span><span class="p">,</span> <span class="s1">'rb'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="__span-21-4"><a href="#__codelineno-21-4" id="__codelineno-21-4" name="__codelineno-21-4"></a>        <span class="n">data</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span id="__span-21-5"><a href="#__codelineno-21-5" id="__codelineno-21-5" name="__codelineno-21-5"></a>
</span><span id="__span-21-6"><a href="#__codelineno-21-6" id="__codelineno-21-6" name="__codelineno-21-6"></a>    <span class="c1"># 将数据倒置</span>
</span><span id="__span-21-7"><a href="#__codelineno-21-7" id="__codelineno-21-7" name="__codelineno-21-7"></a>    <span class="n">reversed_data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="__span-21-8"><a href="#__codelineno-21-8" id="__codelineno-21-8" name="__codelineno-21-8"></a>
</span><span id="__span-21-9"><a href="#__codelineno-21-9" id="__codelineno-21-9" name="__codelineno-21-9"></a>    <span class="c1"># 将倒置后的数据写入输出文件</span>
</span><span id="__span-21-10"><a href="#__codelineno-21-10" id="__codelineno-21-10" name="__codelineno-21-10"></a>    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">output_file</span><span class="p">,</span> <span class="s1">'wb'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="__span-21-11"><a href="#__codelineno-21-11" id="__codelineno-21-11" name="__codelineno-21-11"></a>        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">reversed_data</span><span class="p">)</span>
</span><span id="__span-21-12"><a href="#__codelineno-21-12" id="__codelineno-21-12" name="__codelineno-21-12"></a>
</span><span id="__span-21-13"><a href="#__codelineno-21-13" id="__codelineno-21-13" name="__codelineno-21-13"></a><span class="c1"># 示例用法</span>
</span><span id="__span-21-14"><a href="#__codelineno-21-14" id="__codelineno-21-14" name="__codelineno-21-14"></a><span class="n">input_file</span> <span class="o">=</span> <span class="s1">'flag'</span>
</span><span id="__span-21-15"><a href="#__codelineno-21-15" id="__codelineno-21-15" name="__codelineno-21-15"></a><span class="n">output_file</span> <span class="o">=</span> <span class="s1">'flag_reversed'</span>
</span><span id="__span-21-16"><a href="#__codelineno-21-16" id="__codelineno-21-16" name="__codelineno-21-16"></a><span class="n">reverse_file</span><span class="p">(</span><span class="n">input_file</span><span class="p">,</span> <span class="n">output_file</span><span class="p">)</span>
</span></code></pre></div>
<p><code>file flag_reversed</code>发现该文件其实是一个<span class="heti-skip"><span class="heti-spacing"> </span>JPEG<span class="heti-spacing"> </span></span>类型的文件，猜测与图片隐写有关</p>
<p><span>binwalk<span class="heti-spacing"> </span></span>查看附加文件，<span>-e<span class="heti-spacing"> </span></span>选项自动提取，可以提取出<span><span class="heti-spacing"> </span>flag.txt</span>，查看可以得到<span class="heti-skip"><span class="heti-spacing"> </span>flag<span class="heti-spacing"> </span></span>为<code>BaseCTF{h3ll0_h4cker}</code></p>
<h2 id="week1-捂住x只耳"><span>[Week1]<span class="heti-spacing"> </span></span>捂住<span class="heti-skip"><span class="heti-spacing"> </span>X<span class="heti-spacing"> </span></span>只耳</h2>
<h2 id="week2-ez_crypto">[Week2] ez_crypto</h2>
<div class="language-python highlight"><pre><span></span><code><span id="__span-22-1"><a href="#__codelineno-22-1" id="__codelineno-22-1" name="__codelineno-22-1"></a><span class="kn">import</span> <span class="nn">base64</span>
</span><span id="__span-22-2"><a href="#__codelineno-22-2" id="__codelineno-22-2" name="__codelineno-22-2"></a><span class="n">string</span> <span class="o">=</span> <span class="s2">"qMfZzunurNTuAdfZxZfZxZrUx2v6x2i0C2u2ngrLyZbKzx0="</span>   <span class="c1"># 欲解密的字符串</span>
</span><span id="__span-22-3"><a href="#__codelineno-22-3" id="__codelineno-22-3" name="__codelineno-22-3"></a><span class="n">outtab</span>  <span class="o">=</span> <span class="s2">"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="</span>  <span class="c1">#  原生字母表</span>
</span><span id="__span-22-4"><a href="#__codelineno-22-4" id="__codelineno-22-4" name="__codelineno-22-4"></a><span class="n">intab</span>   <span class="o">=</span> <span class="s2">"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/="</span>  <span class="c1">#  换表之后的字母表</span>
</span><span id="__span-22-5"><a href="#__codelineno-22-5" id="__codelineno-22-5" name="__codelineno-22-5"></a><span class="nb">print</span> <span class="p">(</span><span class="n">base64</span><span class="o">.</span><span class="n">b64decode</span><span class="p">(</span><span class="n">string</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="nb">str</span><span class="o">.</span><span class="n">maketrans</span><span class="p">(</span><span class="n">intab</span><span class="p">,</span><span class="n">outtab</span><span class="p">)))</span><span class="o">.</span><span class="n">decode</span><span class="p">())</span>
</span></code></pre></div>
<p>换表后利用<span class="heti-skip"><span class="heti-spacing"> </span>base64<span class="heti-spacing"> </span></span>解码就可以得到<span><span class="heti-spacing"> </span>Flag</span></p>
<h2 id="week2-base">[Week2] base?!</h2>
<div class="language-text highlight"><pre><span></span><code><span id="__span-23-1"><a href="#__codelineno-23-1" id="__codelineno-23-1" name="__codelineno-23-1"></a>hS5VZPaBjN4IU6G2VFqZqNG-tPrJm64NgMKQuEa3nNIBIFbh0MLBZEpF4LqZn
</span><span id="__span-23-2"><a href="#__codelineno-23-2" id="__codelineno-23-2" name="__codelineno-23-2"></a>9LpBjLoRjPqEV6Lo+
</span><span id="__span-23-3"><a href="#__codelineno-23-3" id="__codelineno-23-3" name="__codelineno-23-3"></a>
</span><span id="__span-23-4"><a href="#__codelineno-23-4" id="__codelineno-23-4" name="__codelineno-23-4"></a>question        response
</span><span id="__span-23-5"><a href="#__codelineno-23-5" id="__codelineno-23-5" name="__codelineno-23-5"></a>
</span><span id="__span-23-6"><a href="#__codelineno-23-6" id="__codelineno-23-6" name="__codelineno-23-6"></a>Base64?         X     
</span><span id="__span-23-7"><a href="#__codelineno-23-7" id="__codelineno-23-7" name="__codelineno-23-7"></a>Base32?         X       
</span></code></pre></div>
<p>利用自动编解码识别工具可知这是 <strong>xxencode</strong> 编码，可能题目中<span class="heti-skip"><span class="heti-spacing"> </span>Base64<span class="heti-spacing"> </span></span>和<span class="heti-skip"><span class="heti-spacing"> </span>Base32<span class="heti-spacing"> </span></span>的<span class="heti-skip"><span class="heti-spacing"> </span>Response "X"<span class="heti-spacing"> </span></span>就是告诉这段编码并非传统意义上的<span><span class="heti-spacing"> </span>Base64</span>（Base32)，还是有点难想到的</p>
<p>顺带介绍一下 <strong>xxencode</strong> 及其姊妹 <strong>uuencode</strong> <span>---<span class="heti-spacing"> </span></span>他们两者其实都是<span class="heti-skip"><span class="heti-spacing"> </span>Base64<span class="heti-spacing"> </span></span>编码的变种</p>
<p>标准<span class="heti-skip"><span class="heti-spacing"> </span>Base64<span class="heti-spacing"> </span></span>编码的字符表为<span><span class="heti-spacing"> </span>A-Za-z0-9+/=</span></p>
<p>而<span class="heti-skip"><span class="heti-spacing"> </span>xxencode<span class="heti-spacing"> </span></span>编码的字符表为<span><span class="heti-spacing"> </span>+-0-9A-Za-z</span>，<span>uuencode<span class="heti-spacing"> </span></span>编码的字符表为<span class="heti-skip"><span class="heti-spacing"> </span>ASCII<span class="heti-spacing"> </span></span>的<span><span class="heti-spacing"> </span>32-95</span>（包含了较多“奇怪”字符）</p>
<hr/>
<p><span>xxencode<span class="heti-spacing"> </span></span>重复以三个字节为一组，如果剩余字节少于三个，则添加尾随零。这<span class="heti-skip"><span class="heti-spacing"> </span>24<span class="heti-spacing"> </span></span>位被分成<span class="heti-skip"><span class="heti-spacing"> </span>4<span class="heti-spacing"> </span></span>个<span class="heti-skip"><span class="heti-spacing"> </span>6<span class="heti-spacing"> </span></span>位数字，<span>6<span class="heti-spacing"> </span></span>位数字的大小刚好是<span><span class="heti-spacing"> </span>0 - 63</span> ，按照下表将数字替换成字符</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-24-1"><a href="#__codelineno-24-1" id="__codelineno-24-1" name="__codelineno-24-1"></a>            1         2         3         4         5         6
</span><span id="__span-24-2"><a href="#__codelineno-24-2" id="__codelineno-24-2" name="__codelineno-24-2"></a> 0123456789012345678901234567890123456789012345678901234567890123
</span><span id="__span-24-3"><a href="#__codelineno-24-3" id="__codelineno-24-3" name="__codelineno-24-3"></a> |         |         |         |         |         |         |
</span><span id="__span-24-4"><a href="#__codelineno-24-4" id="__codelineno-24-4" name="__codelineno-24-4"></a> +-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz
</span></code></pre></div>
<p>每组<span class="heti-skip"><span class="heti-spacing"> </span>60<span class="heti-spacing"> </span></span>个输出字符（对应于<span class="heti-skip"><span class="heti-spacing"> </span>60/4*3=45<span class="heti-spacing"> </span></span>个输入字节）作为单独的行输出，前面有一个编码字符，给出该行上的编码字节数。对于除最后一行之外的所有行，这将是字符“h”（映射到值<span class="heti-skip"><span class="heti-spacing"> </span>45<span class="heti-spacing"> </span></span>的字符<heti-adjacent class="heti-adjacent-half">）</heti-adjacent>。如果输入不能被<span class="heti-skip"><span class="heti-spacing"> </span>45<span class="heti-spacing"> </span></span>整除，则最后一行将包含剩余的<span class="heti-skip"><span class="heti-spacing"> </span>N<span class="heti-spacing"> </span></span>个输出字符，前面是如上编码的剩余输入字节数。最后，输出一行仅包含一个空格（或加号字符）</p>
<p><strong>因此</strong>我们发现题目中的文本非常符合 <strong>xxencode</strong>的编码特征</p>
<p><span>uuencode<span class="heti-spacing"> </span></span>与<span class="heti-skip"><span class="heti-spacing"> </span>xxencode<span class="heti-spacing"> </span></span>类似，也是重复以三个字节为一组，尾随零。将<span class="heti-skip"><span class="heti-spacing"> </span>24<span class="heti-spacing"> </span></span>位二进制数分成<span class="heti-skip"><span class="heti-spacing"> </span>4<span class="heti-spacing"> </span></span>个<span class="heti-skip"><span class="heti-spacing"> </span>6<span class="heti-spacing"> </span></span>位数字，<span>6<span class="heti-spacing"> </span></span>位数字的大小为<span><span class="heti-spacing"> </span>0 - 63</span>，只不过<span class="heti-skip"><span class="heti-spacing"> </span>uuencode<span class="heti-spacing"> </span></span>的字母表替换方式不同，直接在<span class="heti-skip"><span class="heti-spacing"> </span>0 - 63<span class="heti-spacing"> </span></span>上加上<span><span class="heti-spacing"> </span>32</span>，对应到<span class="heti-skip"><span class="heti-spacing"> </span>ASCII<span class="heti-spacing"> </span></span>字符表中的<span class="heti-skip"><span class="heti-spacing"> </span>32 - 95<span class="heti-spacing"> </span></span>号字符。同样每组<span class="heti-skip"><span class="heti-spacing"> </span>60<span class="heti-spacing"> </span></span>个输出字符作为单独的行输出，也有额外加在最前面的表示该行编码的字节数的编码字符，只不过满行<span class="heti-skip"><span class="heti-spacing"> </span>60<span class="heti-spacing"> </span></span>个输出字符所对应的字符应该是<span><span class="heti-spacing"> </span>"M"</span>（映射到<span class="heti-skip"><span class="heti-spacing"> </span>ASCII<span class="heti-spacing"> </span></span>表中第<span class="heti-skip"><span class="heti-spacing"> </span>45+32=77<span class="heti-spacing"> </span></span>位字符）</p>
<h2 id="week-2-二维码1-街头小广告"><span>[Week 2]<span class="heti-spacing"> </span></span>二维码<span class="heti-skip"><span class="heti-spacing"> </span>1-<span class="heti-spacing"> </span></span>街头小广告</h2>
<p><strong><span>---<span class="heti-spacing"> </span></span>来自官方题解（逃</strong></p>
<p>二维码本身具有纠错能力，只要损坏数量不太多，就能自动纠正。尤其是微信<span class="heti-skip"><span class="heti-spacing"> </span>AI<span class="heti-spacing"> </span></span>的纠错能力特别强，出题时凑了很久才凑出来“刚好补个角才能扫，否则不能扫”的效果。</p>
<p>在合适的位置补上右上角定位块（<span>Windows<span class="heti-spacing"> </span></span>画图 或者<span class="heti-skip"><span class="heti-spacing"> </span>PPT<span class="heti-spacing"> </span></span>就行<heti-adjacent class="heti-adjacent-half">）</heti-adjacent>：</p>
<p>这样就能扫了。如果直接用微信之类的扫，会直接跳转到<code>www.basectf.fun</code>，看不到<span><span class="heti-spacing"> </span>flag</span><heti-adjacent class="heti-adjacent-half">。</heti-adjacent>（如果你做题时网站没被微信拦截的话）</p>
<p>二维码本身只是数据的表示形式，二维码与它包含的数据（通常是字节）是等价的。为了检查未知来源二维码的安全性，我们希望只查看二维码内容，而不访问网址。生活中可以用微信小程序“草料二维码”的解码功能方便地做到这件事。<span>CTF<span class="heti-spacing"> </span></span>中可以用<span class="heti-skip"><span class="heti-spacing"> </span>QR Research<span class="heti-spacing"> </span></span>或<span class="heti-skip"><span class="heti-spacing"> </span>QRazyBox<span class="heti-spacing"> </span></span>等工具处理二维码。</p>
<p>本题二维码信息：</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-25-1"><a href="#__codelineno-25-1" id="__codelineno-25-1" name="__codelineno-25-1"></a>https://www.bilibili.com@qr.xinshi.fun/BV11k4y1X7Rj/mal1ci0us?flag=BaseCTF%7BQR_Code_1s_A_f0rM_Of_m3s5ag3%7D
</span></code></pre></div>
<p>其中<code>@</code>前面的<code>www.bilibili.com</code>是用户名，在<span class="heti-skip"><span class="heti-spacing"> </span>HTTP<span class="heti-spacing"> </span></span>协议中无意义、会被忽略，<code>qr.xinshi.fun</code>才是真正的主机名（域名<heti-adjacent class="heti-adjacent-half">）</heti-adjacent>。<span>%7B<span class="heti-spacing"> </span></span>和<span class="heti-skip"><span class="heti-spacing"> </span>%7D<span class="heti-spacing"> </span></span>是<span class="heti-skip"><span class="heti-spacing"> </span>URL<span class="heti-spacing"> </span></span>编码。比赛时间内，<code>qr.xinshi.fun</code>上的<span class="heti-skip"><span class="heti-spacing"> </span>NGINX<span class="heti-spacing"> </span></span>把访问者<span class="heti-skip"><span class="heti-spacing"> </span>302<span class="heti-spacing"> </span></span>重定向到<code>www.basectf.fun</code>，这样就不能打开之后复制链接获得<span class="heti-skip"><span class="heti-spacing"> </span>flag<span class="heti-spacing"> </span></span>了。</p>
<h2 id="week-2-前辈什么的最喜欢了"><span>[Week 2]<span class="heti-spacing"> </span></span>前辈什么的最喜欢了</h2>
<p>观察<span class="heti-skip"><span class="heti-spacing"> </span>.txt<span class="heti-spacing"> </span></span>文档发现开头提示了是经过<span class="heti-skip"><span class="heti-spacing"> </span>Base64<span class="heti-spacing"> </span></span>编码后的<span class="heti-skip"><span class="heti-spacing"> </span>.png<span class="heti-spacing"> </span></span>文件</p>
<p>为此可以写一个简单的<span class="heti-skip"><span class="heti-spacing"> </span>python<span class="heti-spacing"> </span></span>脚本将其转换为原先的图像文件</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-26-1"><a href="#__codelineno-26-1" id="__codelineno-26-1" name="__codelineno-26-1"></a><span class="kn">import</span> <span class="nn">base64</span>
</span><span id="__span-26-2"><a href="#__codelineno-26-2" id="__codelineno-26-2" name="__codelineno-26-2"></a><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">"看着我吧，前辈.txt"</span><span class="p">,</span><span class="s1">'r'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="__span-26-3"><a href="#__codelineno-26-3" id="__codelineno-26-3" name="__codelineno-26-3"></a>    <span class="n">encoded_data</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span id="__span-26-4"><a href="#__codelineno-26-4" id="__codelineno-26-4" name="__codelineno-26-4"></a><span class="n">decoded_data</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64decode</span><span class="p">(</span><span class="n">encoded_data</span><span class="p">)</span>
</span><span id="__span-26-5"><a href="#__codelineno-26-5" id="__codelineno-26-5" name="__codelineno-26-5"></a><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">'data.png'</span><span class="p">,</span><span class="s1">'wb'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="__span-26-6"><a href="#__codelineno-26-6" id="__codelineno-26-6" name="__codelineno-26-6"></a>    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">decoded_data</span><span class="p">)</span>
</span></code></pre></div>
<p><strong>一把梭：</strong></p>
<ol>
<li>
<p>利用<span class="heti-skip"><span class="heti-spacing"> </span>ImageMagic<span class="heti-spacing"> </span></span>查看图片基本信息<span class="heti-skip"><span class="heti-spacing"> </span>-- xdg-open<span class="heti-spacing"> </span></span>尝试打开图片<span class="heti-skip"><span class="heti-spacing"> </span>-- identify<span class="heti-spacing"> </span></span>尝试输出图片基本信息</p>
</li>
<li>
<p>使用<span class="heti-skip"><span class="heti-spacing"> </span>exiftool<span class="heti-spacing"> </span></span>检查图片元信息，看看有没有看起来会有用的信息</p>
</li>
<li>
<p>使用十六进制编辑器打开，观察文件中有无附带信息、图片基本格式是否正确<span class="heti-skip"><span class="heti-spacing"> </span>/<span class="heti-spacing"> </span></span>利用<span class="heti-skip"><span class="heti-spacing"> </span>pngcheck<span class="heti-spacing"> </span></span>检查图片是否存在异常</p>
</li>
<li>
<p>使用<span class="heti-skip"><span class="heti-spacing"> </span>binwalk<span class="heti-spacing"> </span></span>检查文件末尾是否叠加了多余的文件</p>
</li>
<li>
<p>使用<span class="heti-skip"><span class="heti-spacing"> </span>stegsolve<span class="heti-spacing"> </span></span>打开图片<span class="heti-skip"><span class="heti-spacing"> </span>/<span class="heti-spacing"> </span></span>或者使用<span><span class="heti-spacing"> </span>CyberChef</span></p>
</li>
<li>观察各个通道的<span><span class="heti-spacing"> </span>bit plane</span></li>
<li>
<p>使用<span class="heti-skip"><span class="heti-spacing"> </span>Extract LSB<span class="heti-spacing"> </span></span>尝试提取数据格式的<span><span class="heti-spacing"> </span>LSB</span>（或者使用<span class="heti-skip"><span class="heti-spacing"> </span>zsteg<span class="heti-spacing"> </span></span>猜测）</p>
</li>
<li>
<p>考虑能否查找原图，如果找到了尝试进行比较</p>
</li>
</ol>
<p>对于本题目，发现图片不能通过<span class="heti-skip"><span class="heti-spacing"> </span>xdg-open<span class="heti-spacing"> </span></span>正常显示，但可以直接使用<span class="heti-skip"><span class="heti-spacing"> </span>Windows<span class="heti-spacing"> </span></span>系统下的图片查看器打开。并且<span class="heti-skip"><span class="heti-spacing"> </span>pngcheck<span class="heti-spacing"> </span></span>后显示有<span class="heti-skip"><span class="heti-spacing"> </span>crc<span class="heti-spacing"> </span></span>校验错误，于是我们怀疑篡改了<span class="heti-skip"><span class="heti-spacing"> </span>IHDR<span class="heti-spacing"> </span></span>块的宽高数据</p>
<p><img alt="🔥" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/1f525.svg" title=":fire:"/>文件头数据块<span class="heti-skip"><span class="heti-spacing"> </span>IHDR (header chunk):<span class="heti-spacing"> </span></span>包含了<span class="heti-skip"><span class="heti-spacing"> </span>PNG<span class="heti-spacing"> </span></span>文件中储存的图像数据的基本信息，并作为第一个数据块出现在<span class="heti-skip"><span class="heti-spacing"> </span>PNG<span class="heti-spacing"> </span></span>数据流中</p>
<p>紧跟<span class="heti-skip"><span class="heti-spacing"> </span>IHDR<span class="heti-spacing"> </span></span>后的<span class="heti-skip"><span class="heti-spacing"> </span>8<span class="heti-spacing"> </span></span>个字节表示了图像的宽度和高度，例如</p>
<p><code>49 48 44 52 00 00 02 25 00 00 03</code></p>
<p>因此我们直接适当增大图像的宽度和高度，在<span class="heti-skip"><span class="heti-spacing"> </span>Windows<span class="heti-spacing"> </span></span>自带的图片查看器中查看图片便可以看到因高度截取后而隐藏的<span class="heti-skip"><span class="heti-spacing"> </span>flag<span class="heti-spacing"> </span></span>信息（貌似主要是<span class="heti-skip"><span class="heti-spacing"> </span>Windows<span class="heti-spacing"> </span></span>自带的图片查看器对<span class="heti-skip"><span class="heti-spacing"> </span>png<span class="heti-spacing"> </span></span>图像的要求并不是很严格，即使出现校验和错误也会忽视力图能将图像显示出来</p>
<h2 id="week2-黑丝上的flag"><span>[Week2]<span class="heti-spacing"> </span></span>黑丝上的<span><span class="heti-spacing"> </span>flag</span></h2>
<p>原理是降低<span class="heti-skip"><span class="heti-spacing"> </span>flag<span class="heti-spacing"> </span></span>部分的透明度<span class="heti-skip"><span class="heti-spacing"> </span>,<span class="heti-spacing"> </span></span>因为取原图的黑色部分<span class="heti-skip"><span class="heti-spacing"> </span>,<span class="heti-spacing"> </span></span>以黑底显示时基本不影响图片<span class="heti-skip"><span class="heti-spacing"> </span>,<span class="heti-spacing"> </span></span>以白底显示时<span class="heti-skip"><span class="heti-spacing"> </span>flag<span class="heti-spacing"> </span></span>部分变亮<span class="heti-skip"><span class="heti-spacing"> </span>,<span class="heti-spacing"> </span></span>所以进行了部分加深<span><span class="heti-spacing"> </span>.</span></p>
<p>不推荐直接肉眼读取<span class="heti-skip"><span class="heti-spacing"> </span>flag,<span class="heti-spacing"> </span></span>出题人预期方法是编程遍历像素的<code>alpha</code>（透明度）通道<span class="heti-skip"><span class="heti-spacing"> </span>,<span class="heti-spacing"> </span></span>重新用黑白写在新的图片上<span class="heti-skip"><span class="heti-spacing"> </span>---<span class="heti-spacing"> </span></span>摘自官方<span><span class="heti-spacing"> </span>writeup</span></p>
<p>先用<span class="heti-skip"><span class="heti-spacing"> </span>zsteg<span class="heti-spacing"> </span></span>自动识别隐写发现没有什么成效，然后就直接利用<span class="heti-skip"><span class="heti-spacing"> </span>Cyberchef<span class="heti-spacing"> </span></span>的<span class="heti-skip"><span class="heti-spacing"> </span>View Bit Plane<span class="heti-spacing"> </span></span>功能，在最低位上对<span class="heti-skip"><span class="heti-spacing"> </span>red blue green alpha<span class="heti-spacing"> </span></span>做尝试便能找到<span><span class="heti-spacing"> </span>flag</span></p>
<h2 id="week2-海上又遇到了鲨鱼"><span>[Week2]<span class="heti-spacing"> </span></span>海上又遇到了鲨鱼</h2>
<p><strong><span>---<span class="heti-spacing"> </span></span>照搬了官方的<span><span class="heti-spacing"> </span>writeup</span></strong> <img alt="😄" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/1f604.svg" title=":smile:"/></p>
<p><span>Wireshark<span class="heti-spacing"> </span></span>是强大的网络数据捕获与分析工具</p>
<p>打开附件，看到协议为<span class="heti-skip"><span class="heti-spacing"> </span>TCP<span class="heti-spacing"> </span></span>与<span class="heti-skip"><span class="heti-spacing"> </span>FTP<span class="heti-spacing"> </span></span>的分组，可以一个个点击看看是什么<span class="heti-skip"><span class="heti-spacing"> </span>FTP<span class="heti-spacing"> </span></span>协议，<span>ftp-data<span class="heti-spacing"> </span></span>过滤流量包 发现 文件传输了<span><span class="heti-spacing"> </span>flag</span></p>
<p>追踪数据流</p>
<p>将传输文件的所抓到的数据进行导出<span class="heti-skip"><span class="heti-spacing"> </span>Show data as ASCII<span class="heti-spacing"> </span></span>改成 原始数据 另存为<span><span class="heti-spacing"> </span>flag.zip</span></p>
<p>打开压缩包 压缩包有密码且注释也提示我们需要密码而且是重复密码</p>
<p>（可以学一些过滤规则<span><span class="heti-spacing"> </span>ftp contains "230"</span>  （但数据流不多 这行为有些多余了</p>
<p>尝试使用<span class="heti-skip"><span class="heti-spacing"> </span>Ba3eBa3e!@#<span class="heti-spacing"> </span></span>成功解密压缩包</p>
<p>可以看一下整体数据包流量： 一直到流<span class="heti-skip"><span class="heti-spacing"> </span>15<span class="heti-spacing"> </span></span>攻击者爆破<span class="heti-skip"><span class="heti-spacing"> </span>ftp<span class="heti-spacing"> </span></span>服务密码 用户名为<span class="heti-skip"><span class="heti-spacing"> </span>admin<span class="heti-spacing"> </span></span>密码为<span class="heti-skip"><span class="heti-spacing"> </span>Ba3eBa3e!@#<span class="heti-spacing"> </span></span>流<span class="heti-skip"><span class="heti-spacing"> </span>16<span class="heti-spacing"> </span></span>攻击者拿着爆破成功的密码去登陆<span class="heti-skip"><span class="heti-spacing"> </span>ftp<span class="heti-spacing"> </span></span>服务器 执行了<span class="heti-skip"><span class="heti-spacing"> </span>dir<span class="heti-spacing"> </span></span>命令 获取了<span class="heti-skip"><span class="heti-spacing"> </span>ftp<span class="heti-spacing"> </span></span>共享服务目录 发现<span class="heti-skip"><span class="heti-spacing"> </span>flag.zip<span class="heti-spacing"> </span></span>然后<span class="heti-skip"><span class="heti-spacing"> </span>download<span class="heti-spacing"> </span></span>下载了文件 </p>
<h2 id="week2-反方向的雪"><span>[Week2]<span class="heti-spacing"> </span></span>反方向的雪</h2>
<p>题目给了一张图片，利用<span class="heti-skip"><span class="heti-spacing"> </span>xdg-open<span class="heti-spacing"> </span></span>打开没有发现什么异常，<span>identify<span class="heti-spacing"> </span></span>查看也没有什么异常，属于<span class="heti-skip"><span class="heti-spacing"> </span>jpeg<span class="heti-spacing"> </span></span>文件</p>
<p>我们将图片放在<span class="heti-skip"><span class="heti-spacing"> </span>010 editor<span class="heti-spacing"> </span></span>中查看，发现<span class="heti-skip"><span class="heti-spacing"> </span>jpg<span class="heti-spacing"> </span></span>文件尾后还有多余的信息，仔细查看发现是逐字节逆序的<span class="heti-skip"><span class="heti-spacing"> </span>zip<span class="heti-spacing"> </span></span>文件，结合题目名字反方向的提示</p>
<p>将他单独提出来再逐字节逆序，网上可以找到很多类似的工具也可以自己写代码，得到逆序后正常的文件</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-27-1"><a href="#__codelineno-27-1" id="__codelineno-27-1" name="__codelineno-27-1"></a><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">'data.txt'</span><span class="p">,</span><span class="s1">'r'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="__span-27-2"><a href="#__codelineno-27-2" id="__codelineno-27-2" name="__codelineno-27-2"></a>    <span class="n">data</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span id="__span-27-3"><a href="#__codelineno-27-3" id="__codelineno-27-3" name="__codelineno-27-3"></a>    <span class="n">byte_data</span> <span class="o">=</span> <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="__span-27-4"><a href="#__codelineno-27-4" id="__codelineno-27-4" name="__codelineno-27-4"></a>    <span class="n">reversed_data</span> <span class="o">=</span> <span class="n">byte_data</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="__span-27-5"><a href="#__codelineno-27-5" id="__codelineno-27-5" name="__codelineno-27-5"></a>
</span><span id="__span-27-6"><a href="#__codelineno-27-6" id="__codelineno-27-6" name="__codelineno-27-6"></a><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">'data.zip'</span><span class="p">,</span><span class="s1">'wb'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="__span-27-7"><a href="#__codelineno-27-7" id="__codelineno-27-7" name="__codelineno-27-7"></a>    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">reversed_data</span><span class="p">)</span>
</span></code></pre></div>
<p>这样就得到了一个压缩包，需要密码，注释里面有一个提示是<span><span class="heti-spacing"> </span>The_key_is_n0secr3t</span>，但是这好像并不是压缩包的密码，<span>hint<span class="heti-spacing"> </span></span>给出密码为<span class="heti-skip"><span class="heti-spacing"> </span>6<span class="heti-spacing"> </span></span>位，利用妙妙小工具<span class="heti-skip"><span class="heti-spacing"> </span>ARCHPR<span class="heti-spacing"> </span></span>尝试爆破压缩包密码，得到密码是<span><span class="heti-spacing"> </span>123456</span></p>
<p>（注：无法在<span class="heti-skip"><span class="heti-spacing"> </span>Linux<span class="heti-spacing"> </span></span>环境下用<span class="heti-skip"><span class="heti-spacing"> </span>unzip<span class="heti-spacing"> </span></span>解压该压缩包，因为数据并不是以<span class="heti-skip"><span class="heti-spacing"> </span>zip<span class="heti-spacing"> </span></span>方式压缩的）</p>
<p>利用解压缩软件解压后得到<span><span class="heti-spacing"> </span>flag.txt</span>，但是并没有出现<span><span class="heti-spacing"> </span>flag</span></p>
<p>其实文件中有很多空白字符，根据题目雪的提示，这里是<span class="heti-skip"><span class="heti-spacing"> </span>snow<span class="heti-spacing"> </span></span>隐写</p>
<p>利用妙妙小工具<span><span class="heti-spacing"> </span>SNOW.EXE</span> （注：<span>SNOW Home Page<span class="heti-spacing"> </span></span>官网提供的破解程序只能在<span class="heti-skip"><span class="heti-spacing"> </span>windows<span class="heti-spacing"> </span></span>系统下运行）解密，结合之前注释得到的<span><span class="heti-spacing"> </span>key: n0secr3t</span></p>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-28-1"><a href="#__codelineno-28-1" id="__codelineno-28-1" name="__codelineno-28-1"></a>.<span class="se">\S</span>NOW.EXE<span class="w"> </span>-C<span class="w"> </span>-p<span class="w"> </span>n0secr3t<span class="w"> </span>flag.txt
</span></code></pre></div>
<p>就可以解密得到<span><span class="heti-spacing"> </span>flag</span></p>
<h2 id="week2-哇珍德食泥鸭"><span>[Week2]<span class="heti-spacing"> </span></span>哇！珍德食泥鸭</h2>
<p>把<span class="heti-skip"><span class="heti-spacing"> </span>gif<span class="heti-spacing"> </span></span>丢到<span class="heti-skip"><span class="heti-spacing"> </span>binwalk<span class="heti-spacing"> </span></span>中分离，得到了一个<span class="heti-skip"><span class="heti-spacing"> </span>zip<span class="heti-spacing"> </span></span>文件</p>
<p>解压后打开压缩包可以判断文件格式其实是<span><span class="heti-spacing"> </span>docx</span></p>
<hr/>
<p>我们补充一下对<span class="heti-skip"><span class="heti-spacing"> </span>Docx<span class="heti-spacing"> </span></span>文件格式的理解</p>
<p><strong>DOCX</strong> 是<span class="heti-skip"><span class="heti-spacing"> </span>Microsoft Office 2007<span class="heti-spacing"> </span></span>引入的文件格式，基于 <strong>Open XML</strong> 标准。与<span class="heti-skip"><span class="heti-spacing"> </span>DOC<span class="heti-spacing"> </span></span>的二进制格式不同，<span>DOCX<span class="heti-spacing"> </span></span>使用了<span class="heti-skip"><span class="heti-spacing"> </span>XML<span class="heti-spacing"> </span></span>和压缩的结构，更加开放和可解析。实际上，<span>DOCX<span class="heti-spacing"> </span></span>文件就是一个 <strong>ZIP</strong> 文件，包含了多个<span class="heti-skip"><span class="heti-spacing"> </span>XML<span class="heti-spacing"> </span></span>文件和其他资源。</p>
<p><strong><span>DOCX<span class="heti-spacing"> </span></span>文件的结构特点</strong>：</p>
<ul>
<li>
<p><strong><span>ZIP<span class="heti-spacing"> </span></span>压缩格式</strong>：<span>DOCX<span class="heti-spacing"> </span></span>文件本质上是一个压缩文件，可以用<span class="heti-skip"><span class="heti-spacing"> </span>ZIP<span class="heti-spacing"> </span></span>工具（如<span><span class="heti-spacing"> </span>7-Zip</span>、WinRAR）解压缩。</p>
</li>
<li>
<p>目录结构：解压<span class="heti-skip"><span class="heti-spacing"> </span>DOCX<span class="heti-spacing"> </span></span>文件后，可以看到一个包含多个<span class="heti-skip"><span class="heti-spacing"> </span>XML<span class="heti-spacing"> </span></span>文件和资源（如图片、字体等）的文件夹结构。常见的目录结构如下：</p>
</li>
<li>
<p><code>word/：包含文档的主要内容和设置。</code></p>
<ul>
<li><code>document.xml</code>：存储文档的主要内容（文本<heti-adjacent class="heti-adjacent-half">）</heti-adjacent>。</li>
<li><code>styles.xml</code>：定义文档中的样式信息（字体、段落样式等<heti-adjacent class="heti-adjacent-half">）</heti-adjacent>。</li>
<li><code>header1.xml</code>, <code>footer1.xml</code>：存储文档的页眉和页脚。</li>
</ul>
</li>
<li>
<p><code>_rels/</code>：包含关系文件，定义各个<span class="heti-skip"><span class="heti-spacing"> </span>XML<span class="heti-spacing"> </span></span>文件和资源之间的关系。</p>
</li>
<li>
<p><code>docProps/</code>：包含文档的属性（如标题、作者、创建时间等<heti-adjacent class="heti-adjacent-half">）</heti-adjacent>。</p>
</li>
<li>
<p><code>[Content_Types].xml</code>：描述了文档中所有文件的<span class="heti-skip"><span class="heti-spacing"> </span>MIME<span class="heti-spacing"> </span></span>类型。</p>
</li>
</ul>
<p><strong>解析<span class="heti-skip"><span class="heti-spacing"> </span>DOCX<span class="heti-spacing"> </span></span>的<span class="heti-skip"><span class="heti-spacing"> </span>XML<span class="heti-spacing"> </span></span>文件</strong>：</p>
<ul>
<li><strong>document.xml</strong>：是核心的文档内容，使用<span class="heti-skip"><span class="heti-spacing"> </span>XML<span class="heti-spacing"> </span></span>格式存储文档中的所有文本和格式信息。</li>
<li><strong>styles.xml</strong>：包含样式定义，用于指定文档中各种元素（如标题、段落、表格）的外观。</li>
<li><strong>附加资源</strong>：如图片、图表等通常保存在 <code>word/media/</code> 目录中，并在<span class="heti-skip"><span class="heti-spacing"> </span>XML<span class="heti-spacing"> </span></span>文件中引用。</li>
</ul>
<p>得到<span class="heti-skip"><span class="heti-spacing"> </span>Docx<span class="heti-spacing"> </span></span>文件后打开往下翻翻，就可以看到最下面有一张白色图片作为遮挡（通过图片方式是悬浮文字上方判断）</p>
<p>于是我们将其移开，但是并没有发现任何东西，点击工具栏中的显示隐藏文字，再全选将文字颜色改成其他颜色就可以看到<span><span class="heti-spacing"> </span>flag</span> ！</p>
<h2 id="week3-纯鹿人"><span>[Week3]<span class="heti-spacing"> </span></span>纯鹿人</h2>
<p>打开<span class="heti-skip"><span class="heti-spacing"> </span>docx<span class="heti-spacing"> </span></span>文件 全选后发现有一段文字被隐藏，修改文字颜色后发现是一个<span class="heti-skip"><span class="heti-spacing"> </span>base64<span class="heti-spacing"> </span></span>对其解码 内容为压缩包密码</p>
<p>随后把<span class="heti-skip"><span class="heti-spacing"> </span>docx<span class="heti-spacing"> </span></span>改成<span class="heti-skip"><span class="heti-spacing"> </span>zip<span class="heti-spacing"> </span></span>提取出里面的<span class="heti-skip"><span class="heti-spacing"> </span>docx<span class="heti-spacing"> </span></span>图片并进行分解，拿到压缩包 输入前面拿到的解压密码即可得到<span><span class="heti-spacing"> </span>flag</span></p>
<h2 id="week3-base-revenge">[Week3] Base Revenge</h2>
<p>把<span class="heti-skip"><span class="heti-spacing"> </span>Hint<span class="heti-spacing"> </span></span>拖到妙妙工具<span class="heti-skip"><span class="heti-spacing"> </span>--<span class="heti-spacing"> </span></span>编解码工具中一键解码，发现经过<span class="heti-skip"><span class="heti-spacing"> </span>Atbash<span class="heti-spacing"> </span></span>解密后得到了<span class="heti-skip"><span class="heti-spacing"> </span>'This is hint'<span class="heti-spacing"> </span></span>的提示，说明可能需要用到<span class="heti-skip"><span class="heti-spacing"> </span>Atbash<span class="heti-spacing"> </span></span>解码</p>
<p>很明显源文本是一个<span class="heti-skip"><span class="heti-spacing"> </span>Base64<span class="heti-spacing"> </span></span>编码后的文本，我们将文本经过<span class="heti-skip"><span class="heti-spacing"> </span>Base64<span class="heti-spacing"> </span></span>解码后得到了一串英文文本，提示我们这段文本经过了<span class="heti-skip"><span class="heti-spacing"> </span>Base64<span class="heti-spacing"> </span></span>隐写</p>
<p>编写一个<span class="heti-skip"><span class="heti-spacing"> </span>Base64<span class="heti-spacing"> </span></span>隐写的解密脚本<span class="heti-skip"><span class="heti-spacing"> </span>----<span class="heti-spacing"> </span></span>现已归为妙妙工具</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-29-1"><a href="#__codelineno-29-1" id="__codelineno-29-1" name="__codelineno-29-1"></a><span class="kn">import</span> <span class="nn">re</span>
</span><span id="__span-29-2"><a href="#__codelineno-29-2" id="__codelineno-29-2" name="__codelineno-29-2"></a>
</span><span id="__span-29-3"><a href="#__codelineno-29-3" id="__codelineno-29-3" name="__codelineno-29-3"></a><span class="n">path</span> <span class="o">=</span> <span class="s1">'./base_revenge.txt'</span>  
</span><span id="__span-29-4"><a href="#__codelineno-29-4" id="__codelineno-29-4" name="__codelineno-29-4"></a><span class="n">b64char</span> <span class="o">=</span> <span class="s1">'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'</span>
</span><span id="__span-29-5"><a href="#__codelineno-29-5" id="__codelineno-29-5" name="__codelineno-29-5"></a><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">'r'</span><span class="p">)</span><span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="__span-29-6"><a href="#__codelineno-29-6" id="__codelineno-29-6" name="__codelineno-29-6"></a>    <span class="n">cipher</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()]</span>
</span><span id="__span-29-7"><a href="#__codelineno-29-7" id="__codelineno-29-7" name="__codelineno-29-7"></a><span class="n">plaintext</span> <span class="o">=</span> <span class="s1">''</span>
</span><span id="__span-29-8"><a href="#__codelineno-29-8" id="__codelineno-29-8" name="__codelineno-29-8"></a><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">cipher</span><span class="p">:</span>
</span><span id="__span-29-9"><a href="#__codelineno-29-9" id="__codelineno-29-9" name="__codelineno-29-9"></a>    <span class="k">if</span> <span class="n">i</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">'='</span><span class="p">:</span>  <span class="c1"># There are 4-bit hidden info while end with two '='</span>
</span><span id="__span-29-10"><a href="#__codelineno-29-10" id="__codelineno-29-10" name="__codelineno-29-10"></a>        <span class="n">bin_message</span> <span class="o">=</span> <span class="nb">bin</span><span class="p">(</span><span class="n">b64char</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">]))[</span><span class="mi">2</span><span class="p">:]</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</span><span id="__span-29-11"><a href="#__codelineno-29-11" id="__codelineno-29-11" name="__codelineno-29-11"></a>        <span class="n">plaintext</span> <span class="o">+=</span> <span class="n">bin_message</span><span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">:]</span>
</span><span id="__span-29-12"><a href="#__codelineno-29-12" id="__codelineno-29-12" name="__codelineno-29-12"></a>    <span class="k">elif</span> <span class="n">i</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">'='</span><span class="p">:</span>  <span class="c1"># There are 2-bit hidden info while end with one '='</span>
</span><span id="__span-29-13"><a href="#__codelineno-29-13" id="__codelineno-29-13" name="__codelineno-29-13"></a>        <span class="n">bin_message</span> <span class="o">=</span> <span class="nb">bin</span><span class="p">(</span><span class="n">b64char</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]))[</span><span class="mi">2</span><span class="p">:]</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</span><span id="__span-29-14"><a href="#__codelineno-29-14" id="__codelineno-29-14" name="__codelineno-29-14"></a>        <span class="n">plaintext</span> <span class="o">+=</span> <span class="n">bin_message</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">:]</span>
</span><span id="__span-29-15"><a href="#__codelineno-29-15" id="__codelineno-29-15" name="__codelineno-29-15"></a><span class="n">plaintext</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">'.</span><span class="si">{8}</span><span class="s1">'</span><span class="p">,</span> <span class="n">plaintext</span><span class="p">)</span>  <span class="c1"># 8bits/group</span>
</span><span id="__span-29-16"><a href="#__codelineno-29-16" id="__codelineno-29-16" name="__codelineno-29-16"></a><span class="n">plaintext</span> <span class="o">=</span> <span class="s1">''</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">chr</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">plaintext</span><span class="p">])</span>
</span><span id="__span-29-17"><a href="#__codelineno-29-17" id="__codelineno-29-17" name="__codelineno-29-17"></a><span class="nb">print</span><span class="p">(</span><span class="n">plaintext</span><span class="p">)</span>
</span></code></pre></div>
<p>得到隐写的结果后再<span class="heti-skip"><span class="heti-spacing"> </span>Atbash<span class="heti-spacing"> </span></span>解密（这里最好使用<span><span class="heti-spacing"> </span>Cyberchef</span>，因为妙妙工具在<span class="heti-skip"><span class="heti-spacing"> </span>Atbash<span class="heti-spacing"> </span></span>中不区分大小写统一归为小写）</p>
<p><span>Cyberchef<span class="heti-spacing"> </span></span>自动识别经过<span class="heti-skip"><span class="heti-spacing"> </span>Base64<span class="heti-spacing"> </span></span>解码后就能得到<span><span class="heti-spacing"> </span>Flag</span></p>
<h2 id="week3-白丝上的flag"><span>[Week3]<span class="heti-spacing"> </span></span>白丝上的<span><span class="heti-spacing"> </span>flag</span></h2>
<p><strong>题目描述：某出题人赠送大家<span class="heti-skip"><span class="heti-spacing"> </span>flag<span class="heti-spacing"> </span></span>时遭遇了信号干扰<span class="heti-skip"><span class="heti-spacing"> </span>,<span class="heti-spacing"> </span></span>幸好我们在不知名小网站找到了写入<span class="heti-skip"><span class="heti-spacing"> </span>flag<span class="heti-spacing"> </span></span>前的图片<span class="heti-skip"><span class="heti-spacing"> </span>,<span class="heti-spacing"> </span></span>尝试还原信息吧<span><span class="heti-spacing"> </span>!</span></strong></p>
<p>将题目解压后为两张图片和一个<span class="heti-skip"><span class="heti-spacing"> </span>py<span class="heti-spacing"> </span></span>文件</p>
<p>打开<span class="heti-skip"><span class="heti-spacing"> </span>py<span class="heti-spacing"> </span></span>文件发现是一个<strong>图像混淆程序</strong>，主要功能是对输入的图像进行混淆处理，然后将结果保存为一个新的图像文件</p>
<p>猜测<span class="heti-skip"><span class="heti-spacing"> </span>flag<span class="heti-spacing"> </span></span>就写在<span class="heti-skip"><span class="heti-spacing"> </span>en_image<span class="heti-spacing"> </span></span>这张图片里，正好这里有原图，我们可以将没有写<span class="heti-skip"><span class="heti-spacing"> </span>flag<span class="heti-spacing"> </span></span>的图片进行相同的加密后再与<span class="heti-skip"><span class="heti-spacing"> </span>en_image<span class="heti-spacing"> </span></span>进行<strong>异或<span><span class="heti-spacing"> </span>xor</span></strong>处理即可得到<span><span class="heti-spacing"> </span>flag</span></p>
<div class="language-python3 highlight"><pre><span></span><code><span id="__span-30-1"><a href="#__codelineno-30-1" id="__codelineno-30-1" name="__codelineno-30-1"></a><span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>
</span><span id="__span-30-2"><a href="#__codelineno-30-2" id="__codelineno-30-2" name="__codelineno-30-2"></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span><span id="__span-30-3"><a href="#__codelineno-30-3" id="__codelineno-30-3" name="__codelineno-30-3"></a><span class="kn">from</span> <span class="nn">task</span> <span class="kn">import</span> <span class="n">confuse_image</span>
</span><span id="__span-30-4"><a href="#__codelineno-30-4" id="__codelineno-30-4" name="__codelineno-30-4"></a>
</span><span id="__span-30-5"><a href="#__codelineno-30-5" id="__codelineno-30-5" name="__codelineno-30-5"></a><span class="n">image1</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">'en_image.png'</span><span class="p">)</span>
</span><span id="__span-30-6"><a href="#__codelineno-30-6" id="__codelineno-30-6" name="__codelineno-30-6"></a><span class="n">image2</span> <span class="o">=</span> <span class="n">confuse_image</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">'image.png'</span><span class="p">))</span>
</span><span id="__span-30-7"><a href="#__codelineno-30-7" id="__codelineno-30-7" name="__codelineno-30-7"></a>
</span><span id="__span-30-8"><a href="#__codelineno-30-8" id="__codelineno-30-8" name="__codelineno-30-8"></a><span class="n">image1_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">image1</span><span class="p">)</span>
</span><span id="__span-30-9"><a href="#__codelineno-30-9" id="__codelineno-30-9" name="__codelineno-30-9"></a><span class="n">image2_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">image2</span><span class="p">)</span>
</span><span id="__span-30-10"><a href="#__codelineno-30-10" id="__codelineno-30-10" name="__codelineno-30-10"></a>
</span><span id="__span-30-11"><a href="#__codelineno-30-11" id="__codelineno-30-11" name="__codelineno-30-11"></a><span class="n">result_data</span> <span class="o">=</span> <span class="n">image1_data</span> <span class="o">^</span> <span class="n">image2_data</span>
</span><span id="__span-30-12"><a href="#__codelineno-30-12" id="__codelineno-30-12" name="__codelineno-30-12"></a><span class="n">image_result</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">result_data</span><span class="p">)</span>
</span><span id="__span-30-13"><a href="#__codelineno-30-13" id="__codelineno-30-13" name="__codelineno-30-13"></a>
</span><span id="__span-30-14"><a href="#__codelineno-30-14" id="__codelineno-30-14" name="__codelineno-30-14"></a><span class="n">image_result</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">'flag.png'</span><span class="p">)</span>
</span></code></pre></div>
<h2 id="week3">[Week3]</h2>
<h2 id="week4-二维码2-阿喀琉斯之踵"><span>[Week4]<span class="heti-spacing"> </span></span>二维码<span class="heti-skip"><span class="heti-spacing"> </span>2-<span class="heti-spacing"> </span></span>阿喀琉斯之踵</h2>
<p><span>QRazyBox<span class="heti-spacing"> </span></span>打开二维码调整<span><span class="heti-spacing"> </span>Format Info Pattern</span></p>
<p><span>Error Correction Level<span class="heti-spacing"> </span></span>调整为<span><span class="heti-spacing"> </span>H</span>，<span>Mask Pattern<span class="heti-spacing"> </span></span>调整为<span><span class="heti-spacing"> </span>5</span>，<span>Extract QR Information<span class="heti-spacing"> </span></span>即可</p>
<!-- 标题计数器 -->
</article>
</div>
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
</div>
<button class="md-top md-icon" data-md-component="top" hidden="" type="button">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"></path></svg>
  回到页面顶部
</button>
</main>
<footer class="md-footer">
<nav aria-label="页脚" class="md-footer__inner md-grid">
<a aria-label="上一页: Writeups" class="md-footer__link md-footer__link--prev" href="../index.html">
<div class="md-footer__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg>
</div>
<div class="md-footer__title">
<span class="md-footer__direction">
                上一页
              </span>
<div class="md-ellipsis">
                Writeups
              </div>
</div>
</a>
</nav>
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
<div class="md-copyright__highlight">
      Copyright © 2024-2025 <a href="https://github.com/Ader817" rel="noopener" target="_blank">Ader817</a>
</div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
      Material for MkDocs
    </a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": "../..", "features": ["content.action.edit", "content.action.view", "content.code.copy", "content.code.annotate", "header.autohide", "navigation.tabs", "navigation.top", "navigation.footer", "navigation.indexes", "navigation.tracking", "navigation.prune", "search.share", "search.suggest", "search.highlight"], "search": "../../assets/javascripts/workers/search.07f07601.min.js", "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}}</script>
<script src="../../assets/javascripts/bundle.56dfad97.min.js"></script>
<script src="../../assets/javascripts/katex.js"></script>
<script src="../../assets/javascripts/toc.js"></script>
<script src="https://unpkg.com/katex@0/dist/katex.min.js"></script>
<script src="https://unpkg.com/katex@0/dist/contrib/auto-render.min.js"></script>
</body>
</html>