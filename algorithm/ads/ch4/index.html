<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<meta content="Ader's notebook" name="description"/>
<meta content="Ader" name="author"/>
<link href="https://ader817.github.io/notebook/algorithm/ads/ch4/" rel="canonical"/>
<link href="../ch3/" rel="prev"/>
<link href="../ch5/" rel="next"/>
<link href="../../../assets/images/favicon.ico" rel="icon"/>
<meta content="mkdocs-1.6.1, mkdocs-material-9.6.7" name="generator"/>
<title>Chapter 4 | Leftist Heap &amp; Skew Heap - Ader's notebook</title>
<link href="../../../assets/stylesheets/main.8608ea7d.min.css" rel="stylesheet"/>
<link href="../../../assets/stylesheets/palette.06af60db.min.css" rel="stylesheet"/>
<style>:root{--md-admonition-icon--note:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M1 7.775V2.75C1 1.784 1.784 1 2.75 1h5.025c.464 0 .91.184 1.238.513l6.25 6.25a1.75 1.75 0 0 1 0 2.474l-5.026 5.026a1.75 1.75 0 0 1-2.474 0l-6.25-6.25A1.75 1.75 0 0 1 1 7.775m1.5 0c0 .066.026.13.073.177l6.25 6.25a.25.25 0 0 0 .354 0l5.025-5.025a.25.25 0 0 0 0-.354l-6.25-6.25a.25.25 0 0 0-.177-.073H2.75a.25.25 0 0 0-.25.25ZM6 5a1 1 0 1 1 0 2 1 1 0 0 1 0-2"/></svg>');--md-admonition-icon--abstract:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M2.5 1.75v11.5c0 .138.112.25.25.25h3.17a.75.75 0 0 1 0 1.5H2.75A1.75 1.75 0 0 1 1 13.25V1.75C1 .784 1.784 0 2.75 0h8.5C12.216 0 13 .784 13 1.75v7.736a.75.75 0 0 1-1.5 0V1.75a.25.25 0 0 0-.25-.25h-8.5a.25.25 0 0 0-.25.25m13.274 9.537zl-4.557 4.45a.75.75 0 0 1-1.055-.008l-1.943-1.95a.75.75 0 0 1 1.062-1.058l1.419 1.425 4.026-3.932a.75.75 0 1 1 1.048 1.074M4.75 4h4.5a.75.75 0 0 1 0 1.5h-4.5a.75.75 0 0 1 0-1.5M4 7.75A.75.75 0 0 1 4.75 7h2a.75.75 0 0 1 0 1.5h-2A.75.75 0 0 1 4 7.75"/></svg>');--md-admonition-icon--info:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8m8-6.5a6.5 6.5 0 1 0 0 13 6.5 6.5 0 0 0 0-13M6.5 7.75A.75.75 0 0 1 7.25 7h1a.75.75 0 0 1 .75.75v2.75h.25a.75.75 0 0 1 0 1.5h-2a.75.75 0 0 1 0-1.5h.25v-2h-.25a.75.75 0 0 1-.75-.75M8 6a1 1 0 1 1 0-2 1 1 0 0 1 0 2"/></svg>');--md-admonition-icon--tip:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M3.499.75a.75.75 0 0 1 1.5 0v.996C5.9 2.903 6.793 3.65 7.662 4.376l.24.202c-.036-.694.055-1.422.426-2.163C9.1.873 10.794-.045 12.622.26 14.408.558 16 1.94 16 4.25c0 1.278-.954 2.575-2.44 2.734l.146.508.065.22c.203.701.412 1.455.476 2.226.142 1.707-.4 3.03-1.487 3.898C11.714 14.671 10.27 15 8.75 15h-6a.75.75 0 0 1 0-1.5h1.376a4.5 4.5 0 0 1-.563-1.191 3.84 3.84 0 0 1-.05-2.063 4.65 4.65 0 0 1-2.025-.293.75.75 0 0 1 .525-1.406c1.357.507 2.376-.006 2.698-.318l.009-.01a.747.747 0 0 1 1.06 0 .75.75 0 0 1-.012 1.074c-.912.92-.992 1.835-.768 2.586.221.74.745 1.337 1.196 1.621H8.75c1.343 0 2.398-.296 3.074-.836.635-.507 1.036-1.31.928-2.602-.05-.603-.216-1.224-.422-1.93l-.064-.221c-.12-.407-.246-.84-.353-1.29a2.4 2.4 0 0 1-.507-.441 3.1 3.1 0 0 1-.633-1.248.75.75 0 0 1 1.455-.364c.046.185.144.436.31.627.146.168.353.305.712.305.738 0 1.25-.615 1.25-1.25 0-1.47-.95-2.315-2.123-2.51-1.172-.196-2.227.387-2.706 1.345-.46.92-.27 1.774.019 3.062l.042.19.01.05c.348.443.666.949.94 1.553a.75.75 0 1 1-1.365.62c-.553-1.217-1.32-1.94-2.3-2.768L6.7 5.527c-.814-.68-1.75-1.462-2.692-2.619a3.7 3.7 0 0 0-1.023.88c-.406.495-.663 1.036-.722 1.508.116.122.306.21.591.239.388.038.797-.06 1.032-.19a.75.75 0 0 1 .728 1.31c-.515.287-1.23.439-1.906.373-.682-.067-1.473-.38-1.879-1.193L.75 5.677V5.5c0-.984.48-1.94 1.077-2.664.46-.559 1.05-1.055 1.673-1.353z"/></svg>');--md-admonition-icon--success:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.75.75 0 0 1 .018-1.042.75.75 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0"/></svg>');--md-admonition-icon--question:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8m8-6.5a6.5 6.5 0 1 0 0 13 6.5 6.5 0 0 0 0-13M6.92 6.085h.001a.749.749 0 1 1-1.342-.67c.169-.339.436-.701.849-.977C6.845 4.16 7.369 4 8 4a2.76 2.76 0 0 1 1.637.525c.503.377.863.965.863 1.725 0 .448-.115.83-.329 1.15-.205.307-.47.513-.692.662-.109.072-.22.138-.313.195l-.006.004a6 6 0 0 0-.26.16 1 1 0 0 0-.276.245.75.75 0 0 1-1.248-.832c.184-.264.42-.489.692-.661q.154-.1.313-.195l.007-.004c.1-.061.182-.11.258-.161a1 1 0 0 0 .277-.245C8.96 6.514 9 6.427 9 6.25a.61.61 0 0 0-.262-.525A1.27 1.27 0 0 0 8 5.5c-.369 0-.595.09-.74.187a1 1 0 0 0-.34.398M9 11a1 1 0 1 1-2 0 1 1 0 0 1 2 0"/></svg>');--md-admonition-icon--warning:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M6.457 1.047c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0 1 14.082 15H1.918a1.75 1.75 0 0 1-1.543-2.575Zm1.763.707a.25.25 0 0 0-.44 0L1.698 13.132a.25.25 0 0 0 .22.368h12.164a.25.25 0 0 0 .22-.368Zm.53 3.996v2.5a.75.75 0 0 1-1.5 0v-2.5a.75.75 0 0 1 1.5 0M9 11a1 1 0 1 1-2 0 1 1 0 0 1 2 0"/></svg>');--md-admonition-icon--failure:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M2.344 2.343za8 8 0 0 1 11.314 11.314A8.002 8.002 0 0 1 .234 10.089a8 8 0 0 1 2.11-7.746m1.06 10.253a6.5 6.5 0 1 0 9.108-9.275 6.5 6.5 0 0 0-9.108 9.275M6.03 4.97 8 6.94l1.97-1.97a.749.749 0 0 1 1.275.326.75.75 0 0 1-.215.734L9.06 8l1.97 1.97a.749.749 0 0 1-.326 1.275.75.75 0 0 1-.734-.215L8 9.06l-1.97 1.97a.749.749 0 0 1-1.275-.326.75.75 0 0 1 .215-.734L6.94 8 4.97 6.03a.75.75 0 0 1 .018-1.042.75.75 0 0 1 1.042-.018"/></svg>');--md-admonition-icon--danger:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M9.504.43a1.516 1.516 0 0 1 2.437 1.713L10.415 5.5h2.123c1.57 0 2.346 1.909 1.22 3.004l-7.34 7.142a1.25 1.25 0 0 1-.871.354h-.302a1.25 1.25 0 0 1-1.157-1.723L5.633 10.5H3.462c-1.57 0-2.346-1.909-1.22-3.004zm1.047 1.074L3.286 8.571A.25.25 0 0 0 3.462 9H6.75a.75.75 0 0 1 .694 1.034l-1.713 4.188 6.982-6.793A.25.25 0 0 0 12.538 7H9.25a.75.75 0 0 1-.683-1.06l2.008-4.418.003-.006-.004-.009-.006-.006-.008-.001q-.005 0-.009.004"/></svg>');--md-admonition-icon--bug:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M4.72.22a.75.75 0 0 1 1.06 0l1 .999a3.5 3.5 0 0 1 2.441 0l.999-1a.748.748 0 0 1 1.265.332.75.75 0 0 1-.205.729l-.775.776c.616.63.995 1.493.995 2.444v.327q0 .15-.025.292c.408.14.764.392 1.029.722l1.968-.787a.75.75 0 0 1 .556 1.392L13 7.258V9h2.25a.75.75 0 0 1 0 1.5H13v.5q-.002.615-.141 1.186l2.17.868a.75.75 0 0 1-.557 1.392l-2.184-.873A5 5 0 0 1 8 16a5 5 0 0 1-4.288-2.427l-2.183.873a.75.75 0 0 1-.558-1.392l2.17-.868A5 5 0 0 1 3 11v-.5H.75a.75.75 0 0 1 0-1.5H3V7.258L.971 6.446a.75.75 0 0 1 .558-1.392l1.967.787c.265-.33.62-.583 1.03-.722a1.7 1.7 0 0 1-.026-.292V4.5c0-.951.38-1.814.995-2.444L4.72 1.28a.75.75 0 0 1 0-1.06m.53 6.28a.75.75 0 0 0-.75.75V11a3.5 3.5 0 1 0 7 0V7.25a.75.75 0 0 0-.75-.75ZM6.173 5h3.654A.17.17 0 0 0 10 4.827V4.5a2 2 0 1 0-4 0v.327c0 .096.077.173.173.173"/></svg>');--md-admonition-icon--example:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M5 5.782V2.5h-.25a.75.75 0 0 1 0-1.5h6.5a.75.75 0 0 1 0 1.5H11v3.282l3.666 5.76C15.619 13.04 14.543 15 12.767 15H3.233c-1.776 0-2.852-1.96-1.899-3.458Zm-2.4 6.565a.75.75 0 0 0 .633 1.153h9.534a.75.75 0 0 0 .633-1.153L12.225 10.5h-8.45ZM9.5 2.5h-3V6c0 .143-.04.283-.117.403L4.73 9h6.54L9.617 6.403A.75.75 0 0 1 9.5 6Z"/></svg>');--md-admonition-icon--quote:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M1.75 2.5h10.5a.75.75 0 0 1 0 1.5H1.75a.75.75 0 0 1 0-1.5m4 5h8.5a.75.75 0 0 1 0 1.5h-8.5a.75.75 0 0 1 0-1.5m0 5h8.5a.75.75 0 0 1 0 1.5h-8.5a.75.75 0 0 1 0-1.5M2.5 7.75v6a.75.75 0 0 1-1.5 0v-6a.75.75 0 0 1 1.5 0"/></svg>');}</style>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=JetBrains+Mono,+LXGW+WenKai+Screen+GB+Screen:300,300i,400,400i,700,700i%7CJetBrains+Mono,+Consolas:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"JetBrains Mono, LXGW WenKai Screen GB Screen";--md-code-font:"JetBrains Mono, Consolas"}</style>
<link href="../../../css/heti.css" rel="stylesheet"/>
<link href="../../../assets/stylesheets/custom.css" rel="stylesheet"/>
<link href="https://unpkg.com/katex@0/dist/katex.min.css" rel="stylesheet"/>
<link href="https://gcore.jsdelivr.net/npm/lxgw-wenkai-screen-webfont@1.1.0/style.css" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:ital,wght@0,100..800;1,100..800&amp;display=swap" rel="stylesheet"/>
<script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
</head>
<body data-md-color-accent="indigo" data-md-color-primary="blue-grey" data-md-color-scheme="default" dir="ltr">
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#chapter-4--leftist-heap--skew-heap">
          跳转至
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header" data-md-component="header">
<nav aria-label="页眉" class="md-header__inner md-grid">
<a aria-label="Ader's notebook" class="md-header__button md-logo" data-md-component="logo" href="../../.." title="Ader's notebook">
<svg viewbox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M.989 8 .064 2.68a1.342 1.342 0 0 1 1.85-1.462l13.402 5.744a1.13 1.13 0 0 1 0 2.076L1.913 14.782a1.343 1.343 0 0 1-1.85-1.463L.99 8Zm.603-5.288L2.38 7.25h4.87a.75.75 0 0 1 0 1.5H2.38l-.788 4.538L13.929 8Z"></path></svg>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            Ader's notebook
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              Chapter 4 | Leftist Heap &amp; Skew Heap
            
          </span>
</div>
</div>
</div>
<form class="md-header__option" data-md-component="palette">
<input aria-label="切换至夜间模式" class="md-option" data-md-color-accent="indigo" data-md-color-media="(prefers-color-scheme: light)" data-md-color-primary="blue-grey" data-md-color-scheme="default" id="__palette_0" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_1" hidden="" title="切换至夜间模式">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg>
</label>
<input aria-label="切换至日间模式" class="md-option" data-md-color-accent="teal" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-primary="black" data-md-color-scheme="slate" id="__palette_1" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_0" hidden="" title="切换至日间模式">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg>
</label>
</form>
<script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="搜索" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="搜索" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg>
</label>
<nav aria-label="查找" class="md-search__options">
<a aria-label="分享" class="md-search__icon md-icon" data-clipboard="" data-clipboard-text="" data-md-component="search-share" href="javascript:void(0)" tabindex="-1" title="分享">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"></path></svg>
</a>
<button aria-label="清空当前内容" class="md-search__icon md-icon" tabindex="-1" title="清空当前内容" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg>
</button>
</nav>
<div class="md-search__suggest" data-md-component="search-suggest"></div>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="" tabindex="0">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
<ol class="md-search-result__list" role="presentation"></ol>
</div>
</div>
</div>
</div>
</div>
<div class="md-header__source">
<a class="md-source" data-md-component="source" href="https://github.com/Ader817/notebook/" title="前往仓库">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"></path></svg>
</div>
<div class="md-source__repository">
    Ader817/notebook
  </div>
</a>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<nav aria-label="标签" class="md-tabs" data-md-component="tabs">
<div class="md-grid">
<ul class="md-tabs__list">
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../..">
          
  
    
  
  Home

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../../language/">
          
  
    
  
  Language

        </a>
</li>
<li class="md-tabs__item md-tabs__item--active">
<a class="md-tabs__link" href="../../">
          
  
    
  
  Algorithm

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../../software/">
          
  
    
  
  Software

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../../system/">
          
  
    
  
  System

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../../web/">
          
  
    
  
  Web

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../../math/">
          
  
    
  
  Math

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../../writeups/">
          
  
    
  
  Writeups

        </a>
</li>
</ul>
</div>
</nav>
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="导航栏" class="md-nav md-nav--primary md-nav--lifted" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="Ader's notebook" class="md-nav__button md-logo" data-md-component="logo" href="../../.." title="Ader's notebook">
<svg viewbox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M.989 8 .064 2.68a1.342 1.342 0 0 1 1.85-1.462l13.402 5.744a1.13 1.13 0 0 1 0 2.076L1.913 14.782a1.343 1.343 0 0 1-1.85-1.463L.99 8Zm.603-5.288L2.38 7.25h4.87a.75.75 0 0 1 0 1.5H2.38l-.788 4.538L13.929 8Z"></path></svg>
</a>
    Ader's notebook
  </label>
<div class="md-nav__source">
<a class="md-source" data-md-component="source" href="https://github.com/Ader817/notebook/" title="前往仓库">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"></path></svg>
</div>
<div class="md-source__repository">
    Ader817/notebook
  </div>
</a>
</div>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../..">
<span class="md-ellipsis">
    Home
    
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../../language/">
<span class="md-ellipsis">
    Language
    
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_3" type="checkbox"/>
<div class="md-nav__link md-nav__container">
<a class="md-nav__link" href="../../">
<span class="md-ellipsis">
    Algorithm
    
  </span>
</a>
<label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="true" aria-labelledby="__nav_3_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_3">
<span class="md-nav__icon md-icon"></span>
            Algorithm
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_3_2" type="checkbox"/>
<div class="md-nav__link md-nav__container">
<a class="md-nav__link" href="../">
<span class="md-ellipsis">
    高级数据结构与算法分析
    
  </span>
</a>
<label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="true" aria-labelledby="__nav_3_2_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_3_2">
<span class="md-nav__icon md-icon"></span>
            高级数据结构与算法分析
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../ch0/">
<span class="md-ellipsis">
    Balanced Search Trees
    
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../ch2/">
<span class="md-ellipsis">
    Inverted Index
    
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_3_2_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_2_4" id="__nav_3_2_4_label" tabindex="0">
<span class="md-ellipsis">
    Heaps
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="true" aria-labelledby="__nav_3_2_4_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_3_2_4">
<span class="md-nav__icon md-icon"></span>
            Heaps
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../ch3/">
<span class="md-ellipsis">
    Chapter 3 | Inverted File Index
    
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
<span class="md-ellipsis">
    Chapter 4 | Leftist Heap &amp; Skew Heap
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="./">
<span class="md-ellipsis">
    Chapter 4 | Leftist Heap &amp; Skew Heap
    
  </span>
</a>
<nav aria-label="目录" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      目录
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#leftist-heap">
<span class="md-ellipsis">
      Leftist Heap
    </span>
</a>
<nav aria-label="Leftist Heap" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#概述">
<span class="md-ellipsis">
      概述
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#定义">
<span class="md-ellipsis">
      定义
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#性质">
<span class="md-ellipsis">
      性质
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#操作">
<span class="md-ellipsis">
      操作
    </span>
</a>
<nav aria-label="操作" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#合并">
<span class="md-ellipsis">
      合并
    </span>
</a>
<nav aria-label="合并" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#递归式">
<span class="md-ellipsis">
      递归式
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#迭代式">
<span class="md-ellipsis">
      迭代式
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#插入">
<span class="md-ellipsis">
      插入
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#删除">
<span class="md-ellipsis">
      删除
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#skew-heap">
<span class="md-ellipsis">
      Skew Heap
    </span>
</a>
<nav aria-label="Skew Heap" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#概述_1">
<span class="md-ellipsis">
      概述
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#合并_1">
<span class="md-ellipsis">
      合并
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#摊还分析">
<span class="md-ellipsis">
      摊还分析
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../ch5/">
<span class="md-ellipsis">
    Algorithms
    
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../problem/">
<span class="md-ellipsis">
    Problem Set
    
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../../software/">
<span class="md-ellipsis">
    Software
    
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../../system/">
<span class="md-ellipsis">
    System
    
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../../web/">
<span class="md-ellipsis">
    Web
    
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../../math/">
<span class="md-ellipsis">
    Math
    
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../../writeups/">
<span class="md-ellipsis">
    Writeups
    
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="目录" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      目录
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#leftist-heap">
<span class="md-ellipsis">
      Leftist Heap
    </span>
</a>
<nav aria-label="Leftist Heap" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#概述">
<span class="md-ellipsis">
      概述
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#定义">
<span class="md-ellipsis">
      定义
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#性质">
<span class="md-ellipsis">
      性质
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#操作">
<span class="md-ellipsis">
      操作
    </span>
</a>
<nav aria-label="操作" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#合并">
<span class="md-ellipsis">
      合并
    </span>
</a>
<nav aria-label="合并" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#递归式">
<span class="md-ellipsis">
      递归式
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#迭代式">
<span class="md-ellipsis">
      迭代式
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#插入">
<span class="md-ellipsis">
      插入
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#删除">
<span class="md-ellipsis">
      删除
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#skew-heap">
<span class="md-ellipsis">
      Skew Heap
    </span>
</a>
<nav aria-label="Skew Heap" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#概述_1">
<span class="md-ellipsis">
      概述
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#合并_1">
<span class="md-ellipsis">
      合并
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#摊还分析">
<span class="md-ellipsis">
      摊还分析
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<a class="md-content__button md-icon" href="https://github.com/Ader817/notebook/edit/master/docs/algorithm/ads/ch4.md" title="编辑此页">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"></path></svg>
</a>
<a class="md-content__button md-icon" href="https://github.com/Ader817/notebook/raw/master/docs/algorithm/ads/ch4.md" title="查看本页的源代码">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"></path></svg>
</a>
<h1 id="chapter-4--leftist-heap--skew-heap">Chapter 4 | Leftist Heap &amp; Skew Heap</h1>
<div style="margin-top: -30px; font-size: 0.75em; opacity: 0.7;">
<p><span class="twemoji"><svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 2A10 10 0 0 0 2 12a10 10 0 0 0 10 10 10 10 0 0 0 10-10h-2a8 8 0 0 1-8 8 8 8 0 0 1-8-8 8 8 0 0 1 8-8zm6.78 1a.7.7 0 0 0-.48.2l-1.22 1.21 2.5 2.5L20.8 5.7c.26-.26.26-.7 0-.95L19.25 3.2c-.13-.13-.3-.2-.47-.2m-2.41 2.12L9 12.5V15h2.5l7.37-7.38z"></path></svg></span> 约<span class="heti-skip"><span class="heti-spacing"> </span>4753<span class="heti-spacing"> </span></span>个字 <span class="twemoji"><svg viewbox="0 0 640 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M392.8 1.2c-17-4.9-34.7 5-39.6 22l-128 448c-4.9 17 5 34.7 22 39.6s34.7-5 39.6-22l128-448c4.9-17-5-34.7-22-39.6m80.6 120.1c-12.5 12.5-12.5 32.8 0 45.3l89.3 89.4-89.4 89.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l112-112c12.5-12.5 12.5-32.8 0-45.3l-112-112c-12.5-12.5-32.8-12.5-45.3 0zm-306.7 0c-12.5-12.5-32.8-12.5-45.3 0l-112 112c-12.5 12.5-12.5 32.8 0 45.3l112 112c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L77.3 256l89.4-89.4c12.5-12.5 12.5-32.8 0-45.3"></path></svg></span> <span>92<span class="heti-spacing"> </span></span>行代码 <span class="twemoji"><svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M21 17H7V3h14m0-2H7a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V3a2 2 0 0 0-2-2M3 5H1v16a2 2 0 0 0 2 2h16v-2H3m12.96-10.71-2.75 3.54-1.96-2.36L8.5 15h11z"></path></svg></span> <span>20<span class="heti-spacing"> </span></span>张图片 <span class="twemoji"><svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 20c4.42 0 8-3.58 8-8s-3.58-8-8-8-8 3.58-8 8 3.58 8 8 8m0-18c5.5 0 10 4.5 10 10s-4.5 10-10 10C6.47 22 2 17.5 2 12S6.5 2 12 2m.5 11H11V7h1.5v4.26l3.7-2.13.75 1.3z"></path></svg></span> 预计阅读时间<span class="heti-skip"><span class="heti-spacing"> </span>49<span class="heti-spacing"> </span></span>分钟</p>
</div>
<h2 id="leftist-heap">Leftist Heap</h2>
<div class="admonition quote">
<p class="admonition-title">link</p>
<p>OI Wiki: <a href="https://oi-wiki.org/ds/leftist-tree/">https://oi-wiki.org/ds/leftist-tree/</a></p>
<p>Wikipedia: <a href="https://en.wikipedia.org/wiki/Leftist_tree">https://en.wikipedia.org/wiki/Leftist_tree</a></p>
</div>
<hr/>
<h3 id="概述">概述</h3>
<div class="admonition note">
<p class="admonition-title">Preview of Binary Heap</p>
<p>简单过一下二叉堆比较重要的几个操作（以最小堆为例）</p>
<ul>
<li><strong>Insert</strong><span>:<span class="heti-spacing"> </span></span>插入到二叉堆的末尾，再<span><span class="heti-spacing"> </span>Percolate Up:<span class="arithmatex">\(O(log(n))\)</span></span></li>
<li><strong>FindMin</strong><span>:<span class="heti-spacing"> </span></span>直接弹出最顶上的元素<span><span class="heti-spacing"> </span>:<span class="arithmatex">\(O(1)\)</span></span></li>
<li><strong>DeleteMin</strong><span>:<span class="heti-spacing"> </span></span>删除最顶上的元素，以末尾元素替代之，再<span><span class="heti-spacing"> </span>Percolate Down:<span class="arithmatex">\(O(log(n))\)</span></span></li>
<li><strong>BuildHeap</strong><span>:<span class="heti-spacing"> </span></span>可以执行连续插入<span class="heti-skip"><span class="heti-spacing"> </span>:<span class="arithmatex">\(nO(log(n))\)</span>;<span class="heti-spacing"> </span></span>更好的方式是全部排列好，从倒数第二层开始<span><span class="heti-spacing"> </span>Percolate Up:<span class="arithmatex">\(O(n)\)</span> -- from course DS</span></li>
<li><del><strong>Merge(Meld)</strong></del><span>:<span class="heti-spacing"> </span></span>类似<span><span class="heti-spacing"> </span>BuildHeap</span>，可以将一个二叉堆中的元素依次插入另一个二叉堆；但更好的方式是全部打乱再<span><span class="heti-spacing"> </span>BuildHeap:<span class="arithmatex">\(O(n)\)</span></span></li>
</ul>
</div>
<p>我们不太满意<span class="heti-skip"><span class="heti-spacing"> </span>Binary Heap<span class="heti-spacing"> </span></span>的<span><span class="heti-spacing"> </span>Merge</span>，因为全部打乱再<span class="heti-skip"><span class="heti-spacing"> </span>BuildHeap<span class="heti-spacing"> </span></span>的操作消解了两个<span class="heti-skip"><span class="heti-spacing"> </span>Heap<span class="heti-spacing"> </span></span>的特征，虽然说<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(O(n)\)</span><span class="heti-spacing"> </span></span>已经不错了，但是我们还想找到更好的结构来进行快速的堆合并操作，于是左偏堆<span class="heti-skip"><span class="heti-spacing"> </span>(Leftist Heap)<span class="heti-spacing"> </span></span>应运而生<span class="heti-skip"><span class="heti-spacing"> </span>,<span class="heti-spacing"> </span></span>它的堆合并操作的复杂度只要<span><span class="heti-spacing"> </span><span class="arithmatex">\(O(log(n))\)</span></span></p>
<div class="admonition note">
<p class="admonition-title">@cy's ppt</p>
<p><strong>Leftist Heap:</strong>
Order Property – the same
Structure Property – binary tree, but unbalanced</p>
</div>
<p>左偏堆<span class="heti-skip"><span class="heti-spacing"> </span>(Leftlist Heap)<span class="heti-spacing"> </span></span>也是一颗二叉树，不仅具有堆的性质，并且是 <strong>「左偏」</strong> 的，但是由于它并不再是一颗完全二叉树，所以不能像维护大小堆一样用数组来维护它</p>
<div class="admonition question">
<p class="admonition-title">Why arrays?</p>
<p>这里提一嘴为什么堆会用数组存储，使用数组来存储堆的节点信息，有一种天然的优势那就是节省内存空间。因为数组占用的是连续的内存空间，相对于散列存储的结构来说，数组可以节省连续的内存空间，不会将内存打乱。</p>
</div>
<hr/>
<h3 id="定义">定义</h3>
<p>一个左偏堆的结点维护了左右子堆的地址、自身的键值、和一个<strong>距离<span><span class="heti-spacing"> </span>(dist)</span></strong>/<strong>Npl(null path length)</strong></p>
<div class="language-cpp highlight"><pre><span></span><code><span id="__span-0-1"><a href="#__codelineno-0-1" id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="k">struct</span><span class="w"> </span><span class="nc">LeftistHeapNode</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-2"><a href="#__codelineno-0-2" id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="w">    </span><span class="n">ElementType</span><span class="w"> </span><span class="n">val</span><span class="p">;</span>
</span><span id="__span-0-3"><a href="#__codelineno-0-3" id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">dist</span><span class="p">;</span>
</span><span id="__span-0-4"><a href="#__codelineno-0-4" id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="w">    </span><span class="n">LeftistHeapNode</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ls</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">rs</span><span class="p">;</span>
</span><span id="__span-0-5"><a href="#__codelineno-0-5" id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="p">};</span>
</span></code></pre></div>
<div class="admonition definition">
<p class="admonition-title">@cy's ppt</p>
<p>[Definition] <strong>The null path length</strong>,<strong>Npl</strong>(x),of any node X is the length of the shortest path from X to a node without two children. Define Npl(NULL) = -1.</p>
<p>[Definition] <strong>The leftist heap property</strong> is that for every node X in the heap, the null path length of the left child is at least as large as that of the right child.</p>
<p>简单来说，每个节点都额外存储了它到小于<span class="heti-skip"><span class="heti-spacing"> </span>2<span class="heti-spacing"> </span></span>个孩子的节点的最短距离<span><span class="heti-spacing"> </span>dist/Npl</span>，并且对任意节点而言，它的左孩子的<span class="heti-skip"><span class="heti-spacing"> </span>dist &gt;=<span class="heti-spacing"> </span></span>右孩子的<span><span class="heti-spacing"> </span>dist</span>
需要注意的是，dist 不是深度，左偏树的深度没有保证，一条向左的链也符合左偏树的定义。</p>
</div>
<hr/>
<h3 id="性质">性质</h3>
<div class="admonition property">
<p class="admonition-title">properties</p>
<ol>
<li>结点的<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(dist\)</span><span class="heti-spacing"> </span></span>等于<span><span class="heti-spacing"> </span><span class="arithmatex">\(dist_\text{right child} + 1\)</span></span>（假设<span><span class="heti-spacing"> </span><span class="arithmatex">\(dist_\text{NULL} = -1\)</span></span><heti-adjacent class="heti-adjacent-half">）</heti-adjacent>；或者可以说结点的<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(dist\)</span><span class="heti-spacing"> </span></span>就是最右路径的节点数</li>
<li>如果<span><span class="heti-spacing"> </span><span class="arithmatex">\(dist_i = N\)</span></span>，则以<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(i\)</span><span class="heti-spacing"> </span></span>为根的子树<strong>至少</strong>是一个<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(N+1\)</span><span class="heti-spacing"> </span></span>层的完美二叉树，至少有<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(2^{N+1}-1\)</span><span class="heti-spacing"> </span></span>个结点</li>
<li>最右路径有<span class="heti-skip"><span class="heti-spacing"> </span>r<span class="heti-spacing"> </span></span>个节点的左斜堆至少有<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(2^r - 1\)</span><span class="heti-spacing"> </span></span>个节点<span class="heti-skip"><span class="heti-spacing"> </span>/<span class="heti-spacing"> </span></span>有<span class="heti-skip"><span class="heti-spacing"> </span>N<span class="heti-spacing"> </span></span>个节点的左斜堆的最右路径最多有<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(\log_2(N+1)\)</span><span class="heti-spacing"> </span></span>个节点 </li>
</ol>
<p>其中命题<span class="heti-skip"><span class="heti-spacing"> </span>2<span class="heti-spacing"> </span></span>和命题<span class="heti-skip"><span class="heti-spacing"> </span>3<span class="heti-spacing"> </span></span>事实上是等价的</p>
<details class="proof">
<summary>证明</summary>
<p>首先我们明确，如果一棵树的最右路径有<span class="heti-skip"><span class="heti-spacing"> </span>r<span class="heti-spacing"> </span></span>个节点，那么这棵树的<span class="heti-skip"><span class="heti-spacing"> </span>dist<span class="heti-spacing"> </span></span>就等于<span><span class="heti-spacing"> </span>r</span>（根据性质<span><span class="heti-spacing"> </span>1</span>）<span>/<span class="heti-spacing"> </span></span>甚至其实我们就可以将<span class="heti-skip"><span class="heti-spacing"> </span>dist<span class="heti-spacing"> </span></span>定义为最右路径的节点个数。
我们用数学归纳法加以证明：</p>
<ol>
<li>
<p>若<span><span class="heti-spacing"> </span>r = 1</span>，最右路径有<span class="heti-skip"><span class="heti-spacing"> </span>1<span class="heti-spacing"> </span></span>个节点，命题成立；</p>
</li>
<li>
<p>假设命题对于<span class="heti-skip"><span class="heti-spacing"> </span>2,3,4,5,....r<span class="heti-spacing"> </span></span>均成立，考虑左斜堆最右路径具有<span class="heti-skip"><span class="heti-spacing"> </span>r+1<span class="heti-spacing"> </span></span>个节点的情况：根节点的右孩子的最右路径有<span class="heti-skip"><span class="heti-spacing"> </span>r<span class="heti-spacing"> </span></span>个节点，右孩子树至少有<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(2^r - 1\)</span><span class="heti-spacing"> </span></span>个节点；左孩子的最右路径也至少要有<span class="heti-skip"><span class="heti-spacing"> </span>r<span class="heti-spacing"> </span></span>个节点才能满足根节点的左倾性质，因此左孩子树也至少要有<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(2^r - 1\)</span><span class="heti-spacing"> </span></span>个节点；因此根节点的这棵树至少有<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(2*(2^r - 1) + 1 = 2^{r+1} - 1\)</span><span class="heti-spacing"> </span></span>个节点</p>
</li>
</ol>
<p>所以这个定理成立，其实也就可以证明合并的操作是<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(log(n)\)</span><span class="heti-spacing"> </span></span>级别的</p>
</details>
<p><img alt="" src="https://note.isshikih.top/cour_note/D2CX_AdvancedDataStructure/img/22.svg" width="49%"/>
<img alt="" src="https://note.isshikih.top/cour_note/D2CX_AdvancedDataStructure/img/23.svg" width="43%"/></p>
<blockquote>
<p>注意，在示意图中我们省略了结点自身键值的标记，但既然作为一个堆，它就需要满足堆的性质，即结点的键值不大于（不小于）其孩子结点的键值。在实际使用过程中，键值很可能不再是单纯的数，大小关系可能转化为偏序关系。</p>
</blockquote>
</div>
<hr/>
<h3 id="操作">操作</h3>
<p>左偏堆的核心操作就是合并。而其它操作都可以看作是合并的特殊情况。因此我们首先讨论任意两个左偏堆的合并。</p>
<hr/>
<h4 id="合并">合并</h4>
<p>作为左偏堆的核心操作，合并操作自然就是要在满足性质的条件下，合并两个左偏堆。大致思路就是先维护堆的性质，在回溯时维护左偏性质，所以实际上它是一个先自上而下再自下而上的过程。</p>
<p>按照实现方法，左偏堆的合并可以分为递归式和迭代式两种。其中前者可能更为直觉，而后者可视化后则更为直观。</p>
<hr/>
<h5 id="递归式">递归式</h5>
<p>递归式先比较当前两个待合并子树的根结点的键值，选择较小（较大）的那个作为根结点，其左子树依然为左子树，右子树更新为「右子树和另一个待合并子树的合并结果<heti-adjacent class="heti-adjacent-half">」</heti-adjacent>。</p>
<p>当然，在递归地更新完后，我们需要检查左子树和右子树是否满足<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(dist_\text{left child} \geq dist_\text{right child}\)</span><span class="heti-spacing"> </span></span>的性质，如果不满足，我们则需要交换左右子树来维持性质。</p>
<div class="language-cpp highlight"><pre><span></span><code><span id="__span-1-1"><a href="#__codelineno-1-1" id="__codelineno-1-1" name="__codelineno-1-1"></a><span class="n">LeftistHeapNode</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nf">merge</span><span class="p">(</span><span class="n">LeftistHeapNode</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">LeftistHeapNode</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-1-2"><a href="#__codelineno-1-2" id="__codelineno-1-2" name="__codelineno-1-2"></a><span class="w">    </span><span class="c1">// Recursive exit. If any is NULL, return the other as the new root of subtree.</span>
</span><span id="__span-1-3"><a href="#__codelineno-1-3" id="__codelineno-1-3" name="__codelineno-1-3"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">y</span><span class="p">;</span>
</span><span id="__span-1-4"><a href="#__codelineno-1-4" id="__codelineno-1-4" name="__codelineno-1-4"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">x</span><span class="p">;</span>
</span><span id="__span-1-5"><a href="#__codelineno-1-5" id="__codelineno-1-5" name="__codelineno-1-5"></a>
</span><span id="__span-1-6"><a href="#__codelineno-1-6" id="__codelineno-1-6" name="__codelineno-1-6"></a><span class="w">    </span><span class="c1">// If `x`'s val is smaller than `y`'s, swap them, which means we always operates on `x`.</span>
</span><span id="__span-1-7"><a href="#__codelineno-1-7" id="__codelineno-1-7" name="__codelineno-1-7"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="o">-&gt;</span><span class="n">val</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">y</span><span class="o">-&gt;</span><span class="n">val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-1-8"><a href="#__codelineno-1-8" id="__codelineno-1-8" name="__codelineno-1-8"></a><span class="w">        </span><span class="n">swap</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">);</span>
</span><span id="__span-1-9"><a href="#__codelineno-1-9" id="__codelineno-1-9" name="__codelineno-1-9"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-1-10"><a href="#__codelineno-1-10" id="__codelineno-1-10" name="__codelineno-1-10"></a>
</span><span id="__span-1-11"><a href="#__codelineno-1-11" id="__codelineno-1-11" name="__codelineno-1-11"></a><span class="w">    </span><span class="c1">// Merge `x`'s right subtree and `y`, and set `x`'s right subtree to the result.</span>
</span><span id="__span-1-12"><a href="#__codelineno-1-12" id="__codelineno-1-12" name="__codelineno-1-12"></a><span class="w">    </span><span class="n">x</span><span class="o">-&gt;</span><span class="n">rs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">merge</span><span class="p">(</span><span class="n">x</span><span class="o">-&gt;</span><span class="n">rs</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">);</span>
</span><span id="__span-1-13"><a href="#__codelineno-1-13" id="__codelineno-1-13" name="__codelineno-1-13"></a>
</span><span id="__span-1-14"><a href="#__codelineno-1-14" id="__codelineno-1-14" name="__codelineno-1-14"></a><span class="w">    </span><span class="c1">// If `x`'s left subtree's dist is smaller than `x`'s right subtree's dist, swap them.</span>
</span><span id="__span-1-15"><a href="#__codelineno-1-15" id="__codelineno-1-15" name="__codelineno-1-15"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="o">-&gt;</span><span class="n">ls</span><span class="o">-&gt;</span><span class="n">dist</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">x</span><span class="o">-&gt;</span><span class="n">ls</span><span class="o">-&gt;</span><span class="n">dist</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">x</span><span class="o">-&gt;</span><span class="n">rs</span><span class="o">-&gt;</span><span class="n">dist</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-1-16"><a href="#__codelineno-1-16" id="__codelineno-1-16" name="__codelineno-1-16"></a><span class="w">        </span><span class="n">swap</span><span class="p">(</span><span class="n">x</span><span class="o">-&gt;</span><span class="n">ls</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="o">-&gt;</span><span class="n">rs</span><span class="p">);</span>
</span><span id="__span-1-17"><a href="#__codelineno-1-17" id="__codelineno-1-17" name="__codelineno-1-17"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-1-18"><a href="#__codelineno-1-18" id="__codelineno-1-18" name="__codelineno-1-18"></a>
</span><span id="__span-1-19"><a href="#__codelineno-1-19" id="__codelineno-1-19" name="__codelineno-1-19"></a><span class="w">    </span><span class="c1">// Update x's dist.</span>
</span><span id="__span-1-20"><a href="#__codelineno-1-20" id="__codelineno-1-20" name="__codelineno-1-20"></a><span class="w">    </span><span class="n">x</span><span class="o">-&gt;</span><span class="n">dist</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="o">-&gt;</span><span class="n">rs</span><span class="o">-&gt;</span><span class="n">dist</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
</span><span id="__span-1-21"><a href="#__codelineno-1-21" id="__codelineno-1-21" name="__codelineno-1-21"></a>
</span><span id="__span-1-22"><a href="#__codelineno-1-22" id="__codelineno-1-22" name="__codelineno-1-22"></a><span class="w">    </span><span class="c1">// Return x as the new root of subtree.</span>
</span><span id="__span-1-23"><a href="#__codelineno-1-23" id="__codelineno-1-23" name="__codelineno-1-23"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">x</span><span class="p">;</span>
</span><span id="__span-1-24"><a href="#__codelineno-1-24" id="__codelineno-1-24" name="__codelineno-1-24"></a><span class="p">}</span>
</span></code></pre></div>
<div class="admonition eg">
<p class="admonition-title">🌰</p>
<p>现在我们模拟一下这个过程，现在我们有下面两个左偏堆，尝试合并它们。</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:6"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio"/><input id="__tabbed_1_2" name="__tabbed_1" type="radio"/><input id="__tabbed_1_3" name="__tabbed_1" type="radio"/><input id="__tabbed_1_4" name="__tabbed_1" type="radio"/><input id="__tabbed_1_5" name="__tabbed_1" type="radio"/><input id="__tabbed_1_6" name="__tabbed_1" type="radio"/><div class="tabbed-labels"><label for="__tabbed_1_1">Frame 0</label><label for="__tabbed_1_2">Frame 1</label><label for="__tabbed_1_3">Frame 2</label><label for="__tabbed_1_4">Frame 3</label><label for="__tabbed_1_5">Frame 4</label><label for="__tabbed_1_6">Frame 5</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><img alt="" src="https://note.isshikih.top/cour_note/D2CX_AdvancedDataStructure/img/24.svg"/></p>
</div>
<div class="tabbed-block">
<p><img alt="" src="https://note.isshikih.top/cour_note/D2CX_AdvancedDataStructure/img/25.svg"/></p>
<p>我们发现，经过比较，<font color="#2ECC71"><strong>❶</strong></font> 更小，所以我们将 <font color="#2ECC71"><strong>❶</strong></font> 作为合并后的根结点，左子树不变，右子树更新为「绿树右子树和蓝树的合并结果<heti-adjacent class="heti-adjacent-half">」</heti-adjacent>。</p>
</div>
<div class="tabbed-block">
<p><img alt="" src="https://note.isshikih.top/cour_note/D2CX_AdvancedDataStructure/img/26.svg"/></p>
<p>经过比较，<font color="#2E86C1"><strong>❷</strong></font> 更小，所以我们将 <font color="#2E86C1"><strong>❷</strong></font> 作为合并后的根结点，左子树不变，右子树更新为「蓝树右子树和绿树的合并结果<heti-adjacent class="heti-adjacent-half">」</heti-adjacent>。</p>
</div>
<div class="tabbed-block">
<p><img alt="" src="https://note.isshikih.top/cour_note/D2CX_AdvancedDataStructure/img/25.svg"/></p>
<p>最后还剩下两个结点啦！实际上这里直接模拟了两个步骤，首先是比较 <font color="#2ECC71"><strong>❺</strong></font> 和 <font color="#2E86C1"><strong>❻</strong></font>，并选择了 <font color="#2ECC71"><strong>❺</strong></font> 作为新根；接下来在递归的过程中发现需要合并 <code>NULL</code> 和 <font color="#2E86C1"><strong>❻</strong></font>，所以直接返回了 <font color="#2E86C1"><strong>❻</strong></font>。</p>
<p>然而还没有结束，我们还需要处理左右子树<span class="heti-skip"><span class="heti-spacing"> </span>dist<span class="heti-spacing"> </span></span>大小关系问题。</p>
</div>
<div class="tabbed-block">
<p><img alt="" src="https://note.isshikih.top/cour_note/D2CX_AdvancedDataStructure/img/28.svg"/></p>
<p>我们发现 <font color="#2ECC71"><strong>❺</strong></font> 的左孩子为 <code>NULL</code>，我们记<span><span class="heti-spacing"> </span><span class="arithmatex">\(dist_\text{NULL} = -1\)</span></span>，右孩子 <font color="#2E86C1"><strong>❻</strong></font> 有<span><span class="heti-spacing"> </span><span class="arithmatex">\(dist_\text{right child}=0\)</span></span>，所以需要交换两个孩子。</p>
</div>
<div class="tabbed-block">
<p><img alt="" src="https://note.isshikih.top/cour_note/D2CX_AdvancedDataStructure/img/29.svg"/></p>
<p>这里也跳过了两个步骤：</p>
<p>往回走，发现 <font color="#2ECC71"><strong>❺</strong></font> 的<span class="heti-skip"><span class="heti-spacing"> </span>dist<span class="heti-spacing"> </span></span>小于 <font color="#2E86C1"><strong>❹</strong></font> 的<span><span class="heti-spacing"> </span>dist</span>，满足性质，不需要改变。</p>
<p>继续往回走，发现 <font color="#2ECC71"><strong>❷</strong></font> 和 <font color="#2E86C1"><strong>❸</strong></font> 的<span class="heti-skip"><span class="heti-spacing"> </span>dist<span class="heti-spacing"> </span></span>相同，满足性质，也不需要改变。</p>
<p>从这里也可以看出来，并不是看上去更大的子树一定在左侧。</p>
</div>
</div>
</div>
</div>
<hr/>
<h5 id="迭代式">迭代式</h5>
<p>迭代式是根据它的实现方法来命名的，但是我认为从可视化的角度来理解迭代式可能更有意思。事实上在很多题目中我觉得这个方法做题更加方便。</p>
<p>迭代式维护两个额外的指针，分别指向两棵树还没被合并的子树的根，并不断选择较小的那个合并进去，直到两个指针都为空。可以发现，这个过程和归并排序的后半部分非常相似，实际上当我们从可视化的角度去看这件事以后，会发现这里做的<strong>就是一个归并</strong>。</p>
<div class="language-cpp highlight"><pre><span></span><code><span id="__span-2-1"><a href="#__codelineno-2-1" id="__codelineno-2-1" name="__codelineno-2-1"></a><span class="n">LeftistHeapNode</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nf">merge</span><span class="p">(</span><span class="n">LeftistHeapNode</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">LeftistHeapNode</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-2-2"><a href="#__codelineno-2-2" id="__codelineno-2-2" name="__codelineno-2-2"></a><span class="w">    </span><span class="c1">// `tx` &amp; `ty` are the pointers to the roots of the subtrees that haven't been merged.</span>
</span><span id="__span-2-3"><a href="#__codelineno-2-3" id="__codelineno-2-3" name="__codelineno-2-3"></a><span class="w">    </span><span class="n">LeftistHeapNode</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">tx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">y</span><span class="p">;</span>
</span><span id="__span-2-4"><a href="#__codelineno-2-4" id="__codelineno-2-4" name="__codelineno-2-4"></a><span class="w">    </span><span class="c1">// `res` is the root of the merged final tree, while `cur` is the latest node that has been merged.</span>
</span><span id="__span-2-5"><a href="#__codelineno-2-5" id="__codelineno-2-5" name="__codelineno-2-5"></a><span class="w">    </span><span class="n">LeftistHeapNode</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">cur</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
</span><span id="__span-2-6"><a href="#__codelineno-2-6" id="__codelineno-2-6" name="__codelineno-2-6"></a>
</span><span id="__span-2-7"><a href="#__codelineno-2-7" id="__codelineno-2-7" name="__codelineno-2-7"></a><span class="w">    </span><span class="c1">// Begin merging.</span>
</span><span id="__span-2-8"><a href="#__codelineno-2-8" id="__codelineno-2-8" name="__codelineno-2-8"></a><span class="w">    </span><span class="n">whie</span><span class="w"> </span><span class="p">(</span><span class="n">tx</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">ty</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-2-9"><a href="#__codelineno-2-9" id="__codelineno-2-9" name="__codelineno-2-9"></a><span class="w">        </span><span class="c1">// If `tx`'s val is smaller than `ty`'s, swap them, which means we always operates on `tx`.</span>
</span><span id="__span-2-10"><a href="#__codelineno-2-10" id="__codelineno-2-10" name="__codelineno-2-10"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">tx</span><span class="o">-&gt;</span><span class="n">val</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">ty</span><span class="o">-&gt;</span><span class="n">val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-2-11"><a href="#__codelineno-2-11" id="__codelineno-2-11" name="__codelineno-2-11"></a><span class="w">            </span><span class="n">swap</span><span class="p">(</span><span class="n">tx</span><span class="p">,</span><span class="w"> </span><span class="n">ty</span><span class="p">);</span>
</span><span id="__span-2-12"><a href="#__codelineno-2-12" id="__codelineno-2-12" name="__codelineno-2-12"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-2-13"><a href="#__codelineno-2-13" id="__codelineno-2-13" name="__codelineno-2-13"></a>
</span><span id="__span-2-14"><a href="#__codelineno-2-14" id="__codelineno-2-14" name="__codelineno-2-14"></a><span class="w">        </span><span class="c1">// Specially mark the root on the first merge.</span>
</span><span id="__span-2-15"><a href="#__codelineno-2-15" id="__codelineno-2-15" name="__codelineno-2-15"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">res</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-2-16"><a href="#__codelineno-2-16" id="__codelineno-2-16" name="__codelineno-2-16"></a><span class="w">            </span><span class="n">res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tx</span><span class="p">;</span>
</span><span id="__span-2-17"><a href="#__codelineno-2-17" id="__codelineno-2-17" name="__codelineno-2-17"></a><span class="w">            </span><span class="n">cur</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tx</span><span class="p">;</span>
</span><span id="__span-2-18"><a href="#__codelineno-2-18" id="__codelineno-2-18" name="__codelineno-2-18"></a><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-2-19"><a href="#__codelineno-2-19" id="__codelineno-2-19" name="__codelineno-2-19"></a><span class="w">            </span><span class="n">cur</span><span class="o">-&gt;</span><span class="n">rs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tx</span><span class="p">;</span>
</span><span id="__span-2-20"><a href="#__codelineno-2-20" id="__codelineno-2-20" name="__codelineno-2-20"></a><span class="w">            </span><span class="n">cur</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cur</span><span class="o">-&gt;</span><span class="n">rs</span><span class="p">;</span>
</span><span id="__span-2-21"><a href="#__codelineno-2-21" id="__codelineno-2-21" name="__codelineno-2-21"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-2-22"><a href="#__codelineno-2-22" id="__codelineno-2-22" name="__codelineno-2-22"></a>
</span><span id="__span-2-23"><a href="#__codelineno-2-23" id="__codelineno-2-23" name="__codelineno-2-23"></a><span class="w">        </span><span class="c1">// Go on.</span>
</span><span id="__span-2-24"><a href="#__codelineno-2-24" id="__codelineno-2-24" name="__codelineno-2-24"></a><span class="w">        </span><span class="n">tx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tx</span><span class="o">-&gt;</span><span class="n">rs</span><span class="p">;</span>
</span><span id="__span-2-25"><a href="#__codelineno-2-25" id="__codelineno-2-25" name="__codelineno-2-25"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-2-26"><a href="#__codelineno-2-26" id="__codelineno-2-26" name="__codelineno-2-26"></a>
</span><span id="__span-2-27"><a href="#__codelineno-2-27" id="__codelineno-2-27" name="__codelineno-2-27"></a><span class="w">    </span><span class="c1">// Merge the rest of the tree.</span>
</span><span id="__span-2-28"><a href="#__codelineno-2-28" id="__codelineno-2-28" name="__codelineno-2-28"></a><span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">ty</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-2-29"><a href="#__codelineno-2-29" id="__codelineno-2-29" name="__codelineno-2-29"></a><span class="w">        </span><span class="c1">// Specially mark the root on the first merge. (rarely happens but not impossible)</span>
</span><span id="__span-2-30"><a href="#__codelineno-2-30" id="__codelineno-2-30" name="__codelineno-2-30"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">res</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-2-31"><a href="#__codelineno-2-31" id="__codelineno-2-31" name="__codelineno-2-31"></a><span class="w">            </span><span class="n">res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ty</span><span class="p">;</span>
</span><span id="__span-2-32"><a href="#__codelineno-2-32" id="__codelineno-2-32" name="__codelineno-2-32"></a><span class="w">            </span><span class="n">cur</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ty</span><span class="p">;</span>
</span><span id="__span-2-33"><a href="#__codelineno-2-33" id="__codelineno-2-33" name="__codelineno-2-33"></a><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-2-34"><a href="#__codelineno-2-34" id="__codelineno-2-34" name="__codelineno-2-34"></a><span class="w">            </span><span class="n">cur</span><span class="o">-&gt;</span><span class="n">rs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ty</span><span class="p">;</span>
</span><span id="__span-2-35"><a href="#__codelineno-2-35" id="__codelineno-2-35" name="__codelineno-2-35"></a><span class="w">            </span><span class="n">cur</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cur</span><span class="o">-&gt;</span><span class="n">rs</span><span class="p">;</span>
</span><span id="__span-2-36"><a href="#__codelineno-2-36" id="__codelineno-2-36" name="__codelineno-2-36"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-2-37"><a href="#__codelineno-2-37" id="__codelineno-2-37" name="__codelineno-2-37"></a>
</span><span id="__span-2-38"><a href="#__codelineno-2-38" id="__codelineno-2-38" name="__codelineno-2-38"></a><span class="w">        </span><span class="c1">// Go on.</span>
</span><span id="__span-2-39"><a href="#__codelineno-2-39" id="__codelineno-2-39" name="__codelineno-2-39"></a><span class="w">        </span><span class="n">ty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ty</span><span class="o">-&gt;</span><span class="n">rs</span><span class="p">;</span>
</span><span id="__span-2-40"><a href="#__codelineno-2-40" id="__codelineno-2-40" name="__codelineno-2-40"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-2-41"><a href="#__codelineno-2-41" id="__codelineno-2-41" name="__codelineno-2-41"></a>
</span><span id="__span-2-42"><a href="#__codelineno-2-42" id="__codelineno-2-42" name="__codelineno-2-42"></a><span class="w">    </span><span class="c1">// Adjust the left and right subtrees of all the nodes according to the properties of `dist`. </span>
</span><span id="__span-2-43"><a href="#__codelineno-2-43" id="__codelineno-2-43" name="__codelineno-2-43"></a><span class="w">    </span><span class="c1">// It does the same work as the adjust part in the recursive version. I ignore it here.</span>
</span><span id="__span-2-44"><a href="#__codelineno-2-44" id="__codelineno-2-44" name="__codelineno-2-44"></a><span class="w">    </span><span class="n">res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">adjust</span><span class="p">(</span><span class="n">res</span><span class="p">);</span>
</span><span id="__span-2-45"><a href="#__codelineno-2-45" id="__codelineno-2-45" name="__codelineno-2-45"></a>
</span><span id="__span-2-46"><a href="#__codelineno-2-46" id="__codelineno-2-46" name="__codelineno-2-46"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">res</span><span class="p">;</span>
</span><span id="__span-2-47"><a href="#__codelineno-2-47" id="__codelineno-2-47" name="__codelineno-2-47"></a><span class="p">}</span>
</span></code></pre></div>
<p>依旧是以上面进行模拟的那个合并为 🌰 进行模拟。</p>
<div class="admonition eg">
<p class="admonition-title">🌰</p>
<p>首先，我们对图片的排版稍微做一些改变，我们不再按照之前画堆的方式去画，而是“左偏”地去画：</p>
<p><img alt="" src="https://note.isshikih.top/cour_note/D2CX_AdvancedDataStructure/img/30.svg"/></p>
<div class="tabbed-set tabbed-alternate" data-tabs="2:6"><input checked="checked" id="__tabbed_2_1" name="__tabbed_2" type="radio"/><input id="__tabbed_2_2" name="__tabbed_2" type="radio"/><input id="__tabbed_2_3" name="__tabbed_2" type="radio"/><input id="__tabbed_2_4" name="__tabbed_2" type="radio"/><input id="__tabbed_2_5" name="__tabbed_2" type="radio"/><input id="__tabbed_2_6" name="__tabbed_2" type="radio"/><div class="tabbed-labels"><label for="__tabbed_2_1">Frame 0</label><label for="__tabbed_2_2">Frame 1</label><label for="__tabbed_2_3">Frame 2</label><label for="__tabbed_2_4">Frame 3</label><label for="__tabbed_2_5">Frame 4</label><label for="__tabbed_2_6">Frame 5</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><img alt="" src="https://note.isshikih.top/cour_note/D2CX_AdvancedDataStructure/img/31.svg"/></p>
<p>可以发现，在调整之前<span class="heti-skip"><span class="heti-spacing"> </span>,<span class="heti-spacing"> </span></span>绿色和蓝色的箭头分别表示两个待合并子树尚未合并的子树的根，紫色箭头表示最近的合并发生的位置。</p>
</div>
<div class="tabbed-block">
<p><img alt="" src="https://note.isshikih.top/cour_note/D2CX_AdvancedDataStructure/img/32.svg"/></p>
<p>比较 <font color="#2ECC71"><strong>❶</strong></font> 和 <font color="#2E86C1"><strong>❷</strong></font>，发现 <font color="#2ECC71"><strong>❶</strong></font> 更小，所以我们将 <font color="#2ECC71"><strong>❶</strong></font> 作为合并后的根结点，左子树随之合并进去，同时更新绿色箭头指向尚未合并进去的 <font color="#2ECC71"><strong>❺</strong></font>。</p>
</div>
<div class="tabbed-block">
<p><img alt="" src="https://note.isshikih.top/cour_note/D2CX_AdvancedDataStructure/img/33.svg"/></p>
<p>和上一步类似的，比较 <font color="#2ECC71"><strong>❺</strong></font> 和 <font color="#2E86C1"><strong>❷</strong></font>，发现 <font color="#2E86C1"><strong>❷</strong></font> 更小，所以我们将 <font color="#2E86C1"><strong>❷</strong></font> 作为合并后的根结点，左子树随之合并进去，同时更新蓝色箭头指向尚未合并进去的 <font color="#2E86C1"><strong>❻</strong></font>。</p>
</div>
<div class="tabbed-block">
<p><img alt="" src="https://note.isshikih.top/cour_note/D2CX_AdvancedDataStructure/img/34.svg"/></p>
<p>依然类似地，比较 <font color="#2ECC71"><strong>❺</strong></font> 和 <font color="#2E86C1"><strong>❻</strong></font>，发现 <font color="#2ECC71"><strong>❺</strong></font> 更小，所以我们将 <font color="#2ECC71"><strong>❺</strong></font> 作为合并后的根结点，左子树随之合并进去，同时更新绿色箭头指向 <code>NULL</code>。</p>
</div>
<div class="tabbed-block">
<p><img alt="" src="https://note.isshikih.top/cour_note/D2CX_AdvancedDataStructure/img/35.svg"/></p>
<p>这时候我们发现已经有一个指针空了，也就是绿色指针已经指向了 <code>NULL</code>，这个时候我们只需要按顺序把蓝色指针指向的内容都推进去即可。</p>
</div>
<div class="tabbed-block">
<p><img alt="" src="https://note.isshikih.top/cour_note/D2CX_AdvancedDataStructure/img/36.svg"/></p>
<p>接下来我们还需要维护<span class="heti-skip"><span class="heti-spacing"> </span>dist<span class="heti-spacing"> </span></span>信息并根据性质交换左右子树。这一部分和之前一样，就不再赘述了。</p>
</div>
</div>
</div>
</div>
<div class="admonition eg">
<p class="admonition-title">🌰/🔥</p>
<p>当然，这么来看可能还是很乱，联想我们之前发现它和归并排序很像，我们还可以用一个更加直观的方式来看这个过程：</p>
<div class="tabbed-set tabbed-alternate" data-tabs="3:3"><input checked="checked" id="__tabbed_3_1" name="__tabbed_3" type="radio"/><input id="__tabbed_3_2" name="__tabbed_3" type="radio"/><input id="__tabbed_3_3" name="__tabbed_3" type="radio"/><div class="tabbed-labels"><label for="__tabbed_3_1">Frame 0</label><label for="__tabbed_3_2">Frame 1</label><label for="__tabbed_3_3">Frame 2</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><img alt="" src="https://note.isshikih.top/cour_note/D2CX_AdvancedDataStructure/img/30.svg"/></p>
<p>同样从这张图开始，由于我们之前提到的，它类似于一个递归排序的后半部分，具体来说是指合并两个有序数列的过程。</p>
<p>也就是说，我们可以将这两个左偏堆改写成两个有序数列！</p>
</div>
<div class="tabbed-block">
<p><img alt="" src="https://note.isshikih.top/cour_note/D2CX_AdvancedDataStructure/img/37.svg"/></p>
<p>由于我们在合并过程中总是找右孩子，所以我们就沿着最右沿路径把没个左偏堆拆成这种“悬吊”的带状形式，每一“条”的值取决于根的键值，也就是这一“条”的最顶部。</p>
<p>在这张图中，我们得到的两个<strong>有序</strong>数组分别是<font color="#2ECC71"><span class="heti-skip"><span class="heti-spacing"> </span>[1, 5]<span class="heti-spacing"> </span></span></font>和<font color="#2E86C1"><span><span class="heti-spacing"> </span>[2, 6]</span></font>，接下来我们将它们进行排序。</p>
</div>
<div class="tabbed-block">
<p><img alt="" src="https://note.isshikih.top/cour_note/D2CX_AdvancedDataStructure/img/38.svg"/> </p>
<p>经过排序，就会发现它们刚好符合我们在上面步骤得到的结果（可以对比着上面的<span class="heti-skip"><span class="heti-spacing"> </span>Frame 4<span class="heti-spacing"> </span></span>看<heti-adjacent class="heti-adjacent-half">）</heti-adjacent>。实际上，只要你回顾一下归并排序的过程，再对比着看上面的过程，就会发现一模一样。</p>
</div>
</div>
</div>
</div>
<p>在做左斜堆合并的题目时，个人比较喜欢迭代式的做法，只需要沿着最右路径把每个左子树写出来再排序，最后沿着最右路径连回来即可（当然最后还要沿着最右路径对<span class="heti-skip"><span class="heti-spacing"> </span>dist<span class="heti-spacing"> </span></span>进行维护）</p>
<p>再次提醒，这一小节讲的部分都忽略了之后调整子树左偏性质的过程，实际上这也就单纯是一个维护堆性质的过程<span class="heti-skip"><span class="heti-spacing"> </span>--<span class="heti-spacing"> </span></span>只需要对<strong>最右路径<span class="heti-skip"><span class="heti-spacing"> </span>Top-Down<span class="heti-spacing"> </span></span>或者<span class="heti-skip"><span class="heti-spacing"> </span>Bottom-Up<span class="heti-spacing"> </span></span>进行维护即可</strong></p>
<hr/>
<h4 id="插入">插入</h4>
<p>插入可以直接看作是和只有一个根节点的树的合并</p>
<hr/>
<h4 id="删除">删除</h4>
<p>删除操作也比较简单，只需要对被删除节点的两个孩子做合并操作即可</p>
<p>这里贴一段代码方便理解
</p><div class="language-C highlight"><pre><span></span><code><span id="__span-3-1"><a href="#__codelineno-3-1" id="__codelineno-3-1" name="__codelineno-3-1"></a><span class="n">LeftistHeapNode</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nf">del</span><span class="p">(</span><span class="n">LeftistHeapNode</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">cur</span><span class="p">,</span><span class="w"> </span><span class="n">ElementType</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-3-2"><a href="#__codelineno-3-2" id="__codelineno-3-2" name="__codelineno-3-2"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">cur</span><span class="o">-&gt;</span><span class="n">val</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-3-3"><a href="#__codelineno-3-3" id="__codelineno-3-3" name="__codelineno-3-3"></a><span class="w">        </span><span class="c1">// Just return the merge of the children.</span>
</span><span id="__span-3-4"><a href="#__codelineno-3-4" id="__codelineno-3-4" name="__codelineno-3-4"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">merge</span><span class="p">(</span><span class="n">cur</span><span class="o">-&gt;</span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="n">cur</span><span class="o">-&gt;</span><span class="n">r</span><span class="p">);</span>
</span><span id="__span-3-5"><a href="#__codelineno-3-5" id="__codelineno-3-5" name="__codelineno-3-5"></a><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-3-6"><a href="#__codelineno-3-6" id="__codelineno-3-6" name="__codelineno-3-6"></a><span class="w">        </span><span class="c1">// Not this subtree.</span>
</span><span id="__span-3-7"><a href="#__codelineno-3-7" id="__codelineno-3-7" name="__codelineno-3-7"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">cur</span><span class="o">-&gt;</span><span class="n">val</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">cur</span><span class="p">;</span>
</span><span id="__span-3-8"><a href="#__codelineno-3-8" id="__codelineno-3-8" name="__codelineno-3-8"></a>
</span><span id="__span-3-9"><a href="#__codelineno-3-9" id="__codelineno-3-9" name="__codelineno-3-9"></a><span class="w">        </span><span class="c1">// Otherwise, search the `x`.</span>
</span><span id="__span-3-10"><a href="#__codelineno-3-10" id="__codelineno-3-10" name="__codelineno-3-10"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">cur</span><span class="o">-&gt;</span><span class="n">l</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="n">del</span><span class="p">(</span><span class="n">cur</span><span class="o">-&gt;</span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">);</span>
</span><span id="__span-3-11"><a href="#__codelineno-3-11" id="__codelineno-3-11" name="__codelineno-3-11"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">cur</span><span class="o">-&gt;</span><span class="n">r</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="n">del</span><span class="p">(</span><span class="n">cur</span><span class="o">-&gt;</span><span class="n">r</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">);</span>
</span><span id="__span-3-12"><a href="#__codelineno-3-12" id="__codelineno-3-12" name="__codelineno-3-12"></a>
</span><span id="__span-3-13"><a href="#__codelineno-3-13" id="__codelineno-3-13" name="__codelineno-3-13"></a><span class="w">        </span><span class="c1">// Adjust the dist bottom-up.</span>
</span><span id="__span-3-14"><a href="#__codelineno-3-14" id="__codelineno-3-14" name="__codelineno-3-14"></a><span class="w">        </span><span class="n">adjust</span><span class="p">(</span><span class="n">cur</span><span class="p">);</span>
</span><span id="__span-3-15"><a href="#__codelineno-3-15" id="__codelineno-3-15" name="__codelineno-3-15"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-3-16"><a href="#__codelineno-3-16" id="__codelineno-3-16" name="__codelineno-3-16"></a><span class="p">}</span>
</span></code></pre></div>
<hr/>
<h2 id="skew-heap">Skew Heap</h2>
<div class="admonition quote">
<p class="admonition-title">link</p>
<p>Wikipedia: <a href="https://en.wikipedia.org/wiki/Skew_heap">https://en.wikipedia.org/wiki/Skew_heap</a></p>
</div>
<hr/>
<h3 id="概述_1">概述</h3>
<p><span>Skew Heap<span class="heti-spacing"> </span></span>其实是<span class="heti-skip"><span class="heti-spacing"> </span>Leftist Heap<span class="heti-spacing"> </span></span>的一种自适应版本，它们二者之间的关系就类似于<span class="heti-skip"><span class="heti-spacing"> </span>AVL Tree<span class="heti-spacing"> </span></span>和<span class="heti-skip"><span class="heti-spacing"> </span>Splay Tree<span class="heti-spacing"> </span></span>的关系（事实上，发明<span class="heti-skip"><span class="heti-spacing"> </span>Skew Heap<span class="heti-spacing"> </span></span>的人和发明<span class="heti-skip"><span class="heti-spacing"> </span>Splay Tree<span class="heti-spacing"> </span></span>的人是同一个人）</p>
<p><span>Skew Heap<span class="heti-spacing"> </span></span>是一种具有堆性质的二叉树，但是并没有像<span class="heti-skip"><span class="heti-spacing"> </span>Leftist Heap<span class="heti-spacing"> </span></span>一样的对结构上的限制，并没有诸如<span class="heti-skip"><span class="heti-spacing"> </span>Npl<span class="heti-spacing"> </span></span>这样的信息存储在各个节点上，这也就意味着一个<span class="heti-skip"><span class="heti-spacing"> </span>Skew Heap<span class="heti-spacing"> </span></span>的<span class="heti-skip"><span class="heti-spacing"> </span>Right Path<span class="heti-spacing"> </span></span>可能会非常长，这导致了所有操作的最坏时间复杂度是<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(O(n)\)</span><span class="heti-spacing"> </span></span>级别的，但是就像<span class="heti-skip"><span class="heti-spacing"> </span>Spaly Tree<span class="heti-spacing"> </span></span>一样，所有操作在摊还意义下的时间复杂度是<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(O(logn)\)</span><span class="heti-spacing"> </span></span>级别的</p>
<div class="admonition tip">
<p class="admonition-title">另一种视角</p>
<p>让我们回顾一下左偏堆，由于需要自下而上地维护<span><span class="heti-spacing"> </span>dist</span>，所以我们无法进行并发操作。回顾<span class="heti-skip"><span class="heti-spacing"> </span>AVL<span class="heti-spacing"> </span></span>树，同样为了维护它比较严格的平衡性质，我们也无法进行并发操作，而红黑树则通过一个能够仅仅通过变色就能调整的黑高来规避了必须自下而上维护的问题，实现了并发。</p>
<p>换句话来说，要想将左偏堆改变地能够进行自上而下维护，就需要改变甚至放弃它的左偏性质的严格性——而这就是斜堆的由来。</p>
</div>
<hr/>
<h3 id="合并_1">合并</h3>
<p>斜堆也需要满足大根堆（小根堆）的性质，而它的合并和左偏堆的合并也十分类似，只不过我们这次<strong>无条件的交换左右子树</strong>，换句话来说，不管左偏性质如何变化，我们都会选择交换参与合并的左右子树，这样我们就不需要在回溯的时候才进行左右子树的交换，于是就实现了完全的自上而下。</p>
<p>让我们来看看<span class="heti-skip"><span class="heti-spacing"> </span>wiki<span class="heti-spacing"> </span></span>里给出的 🌰：</p>
<div class="admonition eg">
<p class="admonition-title">🌰 from wikipedia</p>
<div class="tabbed-set tabbed-alternate" data-tabs="4:2"><input checked="checked" id="__tabbed_4_1" name="__tabbed_4" type="radio"/><input id="__tabbed_4_2" name="__tabbed_4" type="radio"/><div class="tabbed-labels"><label for="__tabbed_4_1">Frame 0</label><label for="__tabbed_4_2">Frame 1</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><img alt="" src="https://upload.wikimedia.org/wikipedia/commons/thumb/1/19/SkewHeapMerge1.svg/540px-SkewHeapMerge1.svg.png"/></p>
<p>这是我们需要合并的两个堆。</p>
</div>
<div class="tabbed-block">
<p><img alt="" src="https://upload.wikimedia.org/wikipedia/commons/thumb/4/4d/SkewHeapMerge7.svg/1280px-SkewHeapMerge7.svg.png" width="40%"/></p>
<p>省略了中间的步骤，可以尝试模拟一下，每一次合并操作结束之后都交换左右子树。</p>
</div>
</div>
</div>
</div>
<p>大概的操作类似是每次先比较两个子树的根节点大小，把大的子树往小的子树合并，具体合并过程是，将小的子树的左右子树交换，把新的左子树砍掉，让被砍掉的左子树和待合并的树合并后作为新的左子树<span><span class="heti-spacing"> </span>;</span></p>
<p>如果遇到空节点和非空树合并时，若非空节点是该树唯一的最右路径节点，那么就不需要交换左右子树；否则交换左右子树。</p>
<p>当然，它也是支持迭代的写法的，和是和之前的做法类似，我们可以排序每一“条”，然后再合并。<span>Wikipedia<span class="heti-spacing"> </span></span>上提供了一系列的过程图，但是那个过程图有点自下而上的意思，但是实际上自上而下做也是一样的。如果有兴趣可以去看看<span class="heti-skip"><span class="heti-spacing"> </span>Wiki<span class="heti-spacing"> </span></span>上的过程：<a href="https://en.wikipedia.org/wiki/Skew_heap#Non-recursive_merging">🔗</a>。</p>
<hr/>
<h3 id="摊还分析">摊还分析</h3>
<div class="admonition quote">
<p class="admonition-title">link</p>
<p>Halifuda:<a href="https://www.cnblogs.com/halifuda/p/14364632.html">https://www.cnblogs.com/halifuda/p/14364632.html</a></p>
</div>
<p>这里我们采用势能法分析摊还复杂度</p>
<p>分析<span class="heti-skip"><span class="heti-spacing"> </span>skew heap<span class="heti-spacing"> </span></span>的均摊复杂度，主要就是分析<strong>合并</strong>操作的复杂度，因为其他操作都可以转化为合并操作。</p>
<p>接下来我们需要定义势能函数：</p>
<div class="admonition definition">
<p class="admonition-title">势能函数</p>
<p>我们定义<span><span class="heti-spacing"> </span><span class="arithmatex">\(\Phi(Heap) = \text{number of heavy node in } Heap\)</span></span>。</p>
</div>
<p>其中，额外需要定义<span class="heti-skip"><span class="heti-spacing"> </span>heavy node<span class="heti-spacing"> </span></span>和<span><span class="heti-spacing"> </span>light node</span>：</p>
<div class="admonition definition">
<p class="admonition-title">heavy node &amp; light node</p>
<p>对于一个子堆<span><span class="heti-spacing"> </span><span class="arithmatex">\(H\)</span></span>，如果<span><span class="heti-spacing"> </span><span class="arithmatex">\(size(H.\text{right.descendant}) \geq \frac{1}{2}size(H)\)</span></span>，则<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(H\)</span><span class="heti-spacing"> </span></span>是<span><span class="heti-spacing"> </span>heavy node</span>，否则是<span><span class="heti-spacing"> </span>light node</span>。 </p>
<details class="extra">
<summary>\@ cy'ppt</summary>
<p>A node p is heavy if the number of descendants of p’s right subtree is at least half of the number of descendants of p, and light otherwise.  Note that the number of descendants of a node includes the node itself.</p>
</details>
</div>
<p>显然，对于<span class="heti-skip"><span class="heti-spacing"> </span>heavy node<span class="heti-spacing"> </span></span>和<span><span class="heti-spacing"> </span>light node</span>，以及合并操作，有这么一些性质：</p>
<div class="admonition property">
<p class="admonition-title">properties</p>
<ol>
<li>如果一个节点是<span><span class="heti-spacing"> </span>heavy node</span>，并且在其右子树发生了合并（包括翻转<heti-adjacent class="heti-adjacent-half">）</heti-adjacent>，那么它<strong>一定</strong>变为一个<span><span class="heti-spacing"> </span>light node</span>；</li>
<li>如果一个节点是<span><span class="heti-spacing"> </span>light node</span>，并且在其右子树发生了合并（包括翻转<heti-adjacent class="heti-adjacent-half">）</heti-adjacent>，那么它<strong>可能</strong>变为一个<span><span class="heti-spacing"> </span>heavy node</span>；</li>
<li>合并过程中，如果一个节点的<span class="heti-skip"><span class="heti-spacing"> </span>heavy/light<span class="heti-spacing"> </span></span>发生变化，那么它<strong>原先</strong>一定在堆的最右侧路径上；</li>
</ol>
</div>
<p>列出公式：</p>
<div class="arithmatex">\[
\hat{c} = c + \Phi(H_{merged}) - \Phi(H_x) - \Phi(H_y)
\]</div>
<p>其中，<span><span class="arithmatex">\(c\)</span><span class="heti-spacing"> </span></span>为合并操作的（最坏）复杂度，<span><span class="arithmatex">\(H_{merged}\)</span><span class="heti-spacing"> </span></span>为合并后的堆的势能，<span><span class="arithmatex">\(H_x\)</span><span class="heti-spacing"> </span></span>和<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(H_y\)</span><span class="heti-spacing"> </span></span>分别为合并前的两个堆的势能。</p>
<p>根据<span><span class="heti-spacing"> </span>property 3</span>，在合并过程中并非所有节点都收到影响。我们可以单独记录<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(l_{x}\)</span><span class="heti-spacing"> </span></span>为<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(H_x\)</span><span class="heti-spacing"> </span></span>最右侧路径上的<span class="heti-skip"><span class="heti-spacing"> </span>light node<span class="heti-spacing"> </span></span>数量，<span><span class="arithmatex">\(h_{x}\)</span><span class="heti-spacing"> </span></span>为<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(H_x\)</span><span class="heti-spacing"> </span></span>最右侧路径上的<span class="heti-skip"><span class="heti-spacing"> </span>heavy node<span class="heti-spacing"> </span></span>数量，<span><span class="arithmatex">\(h^0_{x}\)</span><span class="heti-spacing"> </span></span>为<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(H_x\)</span><span class="heti-spacing"> </span></span>所有不在最右侧路径上的<span class="heti-skip"><span class="heti-spacing"> </span>heavy node<span class="heti-spacing"> </span></span>数量（即<span><span class="heti-spacing"> </span><span class="arithmatex">\(\text{count of heavy nodes of } H_x = H_x + H^0_x\)</span></span><heti-adjacent class="heti-adjacent-half">）</heti-adjacent>。</p>
<p>于是，我们可以将上式写开：</p>
<div class="arithmatex">\[
\left\{
    \begin{aligned}
        c &amp;= l_x + h_x + l_y + h_y &amp;(1)\\
        \Phi(H_{merged}) &amp;\leq l_x + h^0_x + l_y + h^0_y &amp;(2)\\
        \Phi(H_x) &amp;= h_x + h^0_{x} &amp;(3)\\
        \Phi(H_y) &amp;= h_y + h^0_{y} &amp;(4)
    \end{aligned}
\right.
\]</div>
<p>其中稍微做一些解释：</p>
<ol>
<li><span class="arithmatex">\((1)\)</span>：<span><span class="arithmatex">\(c\)</span><span class="heti-spacing"> </span></span>为合并操作的（最坏）复杂度，即我们的枚举涉及了两个堆所有的右侧路径；</li>
<li><span class="arithmatex">\((2)\)</span>：在合并操作以后，根据<span class="heti-skip"><span class="heti-spacing"> </span>property 1<span class="heti-spacing"> </span></span>和<span><span class="heti-spacing"> </span>property 2</span>，可以得到这个不等式；</li>
<li><span><span class="arithmatex">\((3)\)</span><span class="heti-spacing"> </span></span>和<span><span class="heti-spacing"> </span><span class="arithmatex">\((4)\)</span></span>：根据势能函数的定义得到；</li>
</ol>
<p>于是，将它们代入得到结果：</p>
<div class="arithmatex">\[
\begin{aligned}
\hat{c} 
    &amp;= c + \Phi(H_{merged}) - \Phi(H_x) - \Phi(H_y) \\
    &amp;\leq (l_x + h_x + l_y + h_y)
    + (l_x + h^0_x + l_y + h^0_y)
    - (h_x + h^0_{x})
    - (h_y + h^0_{y}) \\
    &amp;\leq 2(l_x + l_y) \\
\hat{c}
    &amp;= O(\log{N})
\end{aligned}
\]</div>
<details class="proof">
<summary>右路径<span class="heti-skip"><span class="heti-spacing"> </span>light node<span class="heti-spacing"> </span></span>的数量</summary>
<p>证明<span><span class="heti-spacing"> </span><span class="arithmatex">\(l=O(log⁡N)\)</span></span></p>
<blockquote>
<p>注：<span><span class="arithmatex">\(l\)</span><span class="heti-spacing"> </span></span>是堆（最）右侧路径的轻节点数</p>
</blockquote>
<p>我们可以先证明：对于右侧路径上带有<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(l\)</span><span class="heti-spacing"> </span></span>个轻结点的斜堆，至少有<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(2l−1\)</span><span class="heti-spacing"> </span></span>个结点。换句话说，如果一个堆有<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(N\)</span><span class="heti-spacing"> </span></span>个节点，那么它右侧路径上的轻节点个数为<span><span class="heti-spacing"> </span><span class="arithmatex">\(O(log⁡N)\)</span></span>，即<span><span class="heti-spacing"> </span><span class="arithmatex">\(l=O(log⁡N)\)</span></span>，所以只要证出前者，后者自然成立。我们采用归纳法证明（证明过程类似左偏堆那个定理的证明<heti-adjacent class="heti-adjacent-half">）</heti-adjacent>：</p>
<p>当<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(l=1\)</span><span class="heti-spacing"> </span></span>时，显然成立
假设 <span class="arithmatex">\(l≤n\)</span> 时，该结论成立
    那么当 <span class="arithmatex">\(l=n+1\)</span> 时，我们先找到右侧路径的第二个轻节点，根据归纳假设知，以该节点为根节点的子树至少有 <span class="arithmatex">\(2^l−1\)</span> 个节点
    再找第一个轻节点，由轻节点的定义知，它的左子树节点数一定大于右子树节点数，而上面提到的子树位于它的右子树处，所以以第一个轻节点为根节点的子树至少有 <span class="arithmatex">\(2×(2^l−1)+1 = 2^{l+1} - 1\)</span> 个节点。那么整个堆的节点个数一定大于 <span class="arithmatex">\(2×(2^l−1)+1 = 2^{l+1} - 1\)</span> ，得证</p>
</details>
<div class="admonition info">
<p class="admonition-title">一些小结论</p>
<div class="tabbed-set tabbed-alternate" data-tabs="5:2"><input checked="checked" id="__tabbed_5_1" name="__tabbed_5" type="radio"/><input id="__tabbed_5_2" name="__tabbed_5" type="radio"/><div class="tabbed-labels"><label for="__tabbed_5_1">Conclusion 1</label><label for="__tabbed_5_2">Conclustion 2</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>向一个空的斜堆依次插入<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(1\text{~}2^{k−1}(k&gt;4)\)</span><span class="heti-spacing"> </span></span>这几个元素后，得到的堆是一棵满二叉树</p>
</div>
<div class="tabbed-block">
<p>The right path of a skew heap can be arbitrarily long</p>
<p><span>skew heap<span class="heti-spacing"> </span></span>最右路径上只有轻结点受类似<span class="heti-skip"><span class="heti-spacing"> </span>leftist heap<span class="heti-spacing"> </span></span>的限制。</p>
<p>相对而言，<span>leftist heap<span class="heti-spacing"> </span></span>的最右路径就不能这么任意了，它受<span><span class="heti-spacing"> </span>log</span>⁡<span>N<span class="heti-spacing"> </span></span>限制</p>
</div>
</div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Self-adjusting Data Structure</p>
<p>In typical applications of data structures, it is not a single operation that is performed, but rather a sequence of operations, and the relevant complexity measure is not the time taken by one operation but the total time of a sequence. Hence instead of imposing any explicit structural constraint, we allow the data structure to be in an arbitrary state, and we design the access and update algorithms to adjust the structure in a simple, uniform way, so that the efficiency of future operations is improved. We call such a data structure <strong>self-adjusting</strong>. For example skew heaps and splay trees are such kind of structures.</p>
</div>
<!-- 标题计数器 -->
<link href="../../../assets/stylesheets/counter.css" rel="stylesheet"/>
</article>
</div>
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
</div>
<button class="md-top md-icon" data-md-component="top" hidden="" type="button">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"></path></svg>
  回到页面顶部
</button>
</main>
<footer class="md-footer">
<nav aria-label="页脚" class="md-footer__inner md-grid">
<a aria-label="上一页: Chapter 3 | Inverted File Index" class="md-footer__link md-footer__link--prev" href="../ch3/">
<div class="md-footer__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg>
</div>
<div class="md-footer__title">
<span class="md-footer__direction">
                上一页
              </span>
<div class="md-ellipsis">
                Chapter 3 | Inverted File Index
              </div>
</div>
</a>
<a aria-label="下一页: Chapter 5 | Binomial Queue &amp;amp; Fibonacci Heap" class="md-footer__link md-footer__link--next" href="../ch5/">
<div class="md-footer__title">
<span class="md-footer__direction">
                下一页
              </span>
<div class="md-ellipsis">
                Chapter 5 | Binomial Queue &amp; Fibonacci Heap
              </div>
</div>
<div class="md-footer__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"></path></svg>
</div>
</a>
</nav>
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
<div class="md-copyright__highlight">
      Copyright © 2024-2025 <a href="https://github.com/Ader817" rel="noopener" target="_blank">Ader817</a>
</div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
      Material for MkDocs
    </a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": "../../..", "features": ["content.action.edit", "content.action.view", "content.code.copy", "content.code.annotate", "header.autohide", "navigation.tabs", "navigation.top", "navigation.footer", "navigation.indexes", "navigation.tracking", "navigation.prune", "search.share", "search.suggest", "search.highlight"], "search": "../../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}}</script>
<script src="../../../assets/javascripts/bundle.c8b220af.min.js"></script>
<script src="../../../assets/javascripts/katex.js"></script>
<script src="../../../assets/javascripts/toc.js"></script>
<script src="https://unpkg.com/katex@0/dist/katex.min.js"></script>
<script src="https://unpkg.com/katex@0/dist/contrib/auto-render.min.js"></script>
</body>
</html>